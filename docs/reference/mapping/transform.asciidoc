[[mapping-transform]]
== Transform
coming[1.3.0]

The document can be transformed before it is indexed by registering a
script in the `transform` element of the mapping.  The result of the
transform is indexed but the original source is stored in the `_source`
field.  Example:

[source,js]
--------------------------------------------------
{
    "example" : {
        "transform" : {
            "script" : "if (source['title']?.startsWith('t')) source['suggest'] = source['content']",
            "params" : {
                "variable" : "not used but an example anyway"
            },
            "lang": "groovy"
        },
        "properties": {
           "title": { "type": "string" },
           "content": { "type": "string" },
           "suggest": { "type": "string" }
        }
    }
}
--------------------------------------------------

Its also possible to specify transform in short form which uses the
default scripting language and no parameters:
[source,js]
--------------------------------------------------
{
    "example" : {
        "transform" : "source['suggest'] = source['content']"
    }
}
--------------------------------------------------

Because the result isn't stored in the source it can't be fetched by
source filtering.  It can be highlighted if it is marked as stored.

=== Get Transformed
The get endpoint will retransform the source if the `_source_transform`
parameter is set.  Example:

[source,bash]
--------------------------------------------------
curl -XGET "http://localhost:9200/test/test/3?pretty&_source_transform"
--------------------------------------------------

The transform is performed before any source filtering but it is mostly
designed to make it easy to see what was passed to the index.

=== Immutable Transformation
Once configured the transform script cannot be modified.  This is not
because that is technically impossible but instead because madness lies
down that road.
