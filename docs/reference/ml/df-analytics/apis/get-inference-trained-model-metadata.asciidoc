[role="xpack"]
[testenv="basic"]
[[get-inference-metadata]]
= Get trained model metadata API
[subs="attributes"]
++++
<titleabbrev>Get {infer} trained model metadata</titleabbrev>
++++

Retrieves training metadata information for trained models.

experimental[]


[[ml-get-inference-metadata-request]]
== {api-request-title}

`GET _ml/inference/_metadata` +

`GET _ml/inference/_all/_metadata` +

`GET _ml/inference/<model_id>/_metadata` +

`GET _ml/inference/<model_id>,<model_id_2>/_metadata` +

`GET _ml/inference/<model_id_pattern*>,<model_id_2>/_metadata`


[[ml-get-inference-metadata-prereq]]
== {api-prereq-title}

If the {es} {security-features} are enabled, you must have the following
privileges:

* cluster: `monitor_ml`

For more information, see <<security-privileges>> and {ml-docs-setup-privileges}.

[[ml-get-inference-metadata-desc]]
== {api-description-title}

You can get metadata for multiple trained models in a single API
request by using a comma-separated list of model IDs or a wildcard expression.


[[ml-get-inference-metadata-path-params]]
== {api-path-parms-title}

`<model_id>`::
(Optional, string)
include::{es-repo-dir}/ml/ml-shared.asciidoc[tag=model-id]


[[ml-get-inference-metadata-query-params]]
== {api-query-parms-title}

`allow_no_match`::
(Optional, boolean)
include::{es-repo-dir}/ml/ml-shared.asciidoc[tag=allow-no-match-models]

`from`::
(Optional, integer)
include::{es-repo-dir}/ml/ml-shared.asciidoc[tag=from-models]

`size`::
(Optional, integer)
include::{es-repo-dir}/ml/ml-shared.asciidoc[tag=size-models]

[role="child_attributes"]
[[ml-get-inference-metadata-results]]
== {api-response-body-title}

`count`::
(integer)
The total number of trained model metadata objects that matched the requested ID patterns.
Could be higher than the number of items in the `trained_models_metadata` array as the
size of the array is restricted by the supplied `size` parameter.

`trained_models_metadata`::
(array)
An array of trained model metadata objects, which are sorted by the `model_id` value in
ascending order.
+
.Properties of trained model metadata
[%collapsible%open]
====
`model_id`:::
(string)
include::{es-repo-dir}/ml/ml-shared.asciidoc[tag=model-id]

`total_feature_importance`:::
(array)
An array of the total feature importance for each training feature used from
the training data set.
+
.Properties of total feature importance
[%collapsible%open]
=====

`feature_name`:::
(string)
include::{es-repo-dir}/ml/ml-shared.asciidoc[tag=inference-metadata-feature-importance-feature-name]

`importance`:::
(object)
A collection of feature importance statistics related to the training data set for this particular feature.
+
.Properties of feature importance
[%collapsible%open]
======
`mean_magnitude`:::
(double)
include::{es-repo-dir}/ml/ml-shared.asciidoc[tag=inference-metadata-feature-importance-magnitude]

`max`:::
(int)
include::{es-repo-dir}/ml/ml-shared.asciidoc[tag=inference-metadata-feature-importance-max]

`min`:::
(int)
include::{es-repo-dir}/ml/ml-shared.asciidoc[tag=inference-metadata-feature-importance-min]

======

`classes`:::
(array)
If the trained model is a classification model, feature importance statistics are gathered
per target class value.
+
.Properties of class feature importance
[%collapsible%open]

======

`class_name`:::
(string)
The target class value. Could be a string, boolean, or number.

`importance`:::
(object)
A collection of feature importance statistics related to the training data set for this particular feature.
+
.Properties of feature importance
[%collapsible%open]
=======
`mean_magnitude`:::
(double)
include::{es-repo-dir}/ml/ml-shared.asciidoc[tag=inference-metadata-feature-importance-magnitude]

`max`:::
(int)
include::{es-repo-dir}/ml/ml-shared.asciidoc[tag=inference-metadata-feature-importance-max]

`min`:::
(int)
include::{es-repo-dir}/ml/ml-shared.asciidoc[tag=inference-metadata-feature-importance-min]

=======

======

=====

====

[[ml-get-inference-metadata-response-codes]]
== {api-response-codes-title}

`404` (Missing resources)::
  If `allow_no_match` is `false`, this code indicates that there are no
  resources that match the request or only partial matches for the request.

[[ml-get-inference-metadata-example]]
== {api-examples-title}

The following example gets training metadata for all the trained models:

[source,console]
--------------------------------------------------
GET _ml/inference/_metadata
--------------------------------------------------
// TEST[skip:TBD]


The API returns the following results:

[source,console-result]
----
{
  "count" : 2,
  "trained_models_metadata" : [
    {
      "model_id" : "avg_price_prediction-1599149443166",
      "total_feature_importance" : [
        {
          "feature_name" : "Origin",
          "importance" : {
            "mean_magnitude" : 25.862683737654795,
            "min" : -188.93284143727874,
            "max" : 162.8783518094679
          }
        },
        ...
      ]
    },
    {
      "model_id" : "dest_weather_prediction-1599149568413",
      "total_feature_importance" : [
        {
          "feature_name" : "dayOfWeek",
          "classes" : [
            {
              "class_name" : "Clear",
              "importance" : {
                "mean_magnitude" : 0.0033597810869050483,
                "min" : -0.034589509802599394,
                "max" : 0.013677011897069439
              }
            },
            {
              "class_name" : "Cloudy",
              "importance" : {
                "mean_magnitude" : 0.003549516620011909,
                "min" : -0.06736294734141816,
                "max" : 0.088650519638185
              }
            },
            {
              "class_name" : "Sunny",
              "importance" : {
                "mean_magnitude" : 0.004471474339413112,
                "min" : -0.08060353377909144,
                "max" : 0.1045130657148837
              }
            },
            {
              "class_name" : "Hail",
              "importance" : {
                "mean_magnitude" : 0.007072062864425885,
                "min" : -0.05044235221609796,
                "max" : 0.038623432806435085
              }
            },
            {
              "class_name" : "Heavy Fog",
              "importance" : {
                "mean_magnitude" : 0.0065139540458721236,
                "min" : -0.018591621408001358,
                "max" : 0.03543735929759353
              }
            },
            {
              "class_name" : "Thunder & Lightning",
              "importance" : {
                "mean_magnitude" : 0.0066567969304509155,
                "min" : -0.059528507259167134,
                "max" : 0.03628958395628503
              }
            },
            {
              "class_name" : "Rain",
              "importance" : {
                "mean_magnitude" : 0.0038758238618025985,
                "min" : -0.07831548102713791,
                "max" : 0.05696179640413974
              }
            },
            {
              "class_name" : "Damaging Wind",
              "importance" : {
                "mean_magnitude" : 0.0113605093018583,
                "min" : -0.053221001966268555,
                "max" : 0.07941614599243701
              }
            }
          ]
        },
        ...
      ]
    }
  ]
}
----
// NOTCONSOLE
