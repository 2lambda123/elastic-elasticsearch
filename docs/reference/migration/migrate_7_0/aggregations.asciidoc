[[breaking_70_aggregations_changes]]
=== Aggregations changes

==== Deprecated `global_ordinals_hash` and `global_ordinals_low_cardinality` execution hints for terms aggregations have been removed

These `execution_hint` are removed and should be replaced by `global_ordinals`.

==== `search.max_buckets` in the cluster setting

The dynamic cluster setting named `search.max_buckets` now defaults
to 10,000 (instead of unlimited in the previous version).
Requests that try to return more than the limit will fail with an exception.

==== `missing` option of the `composite` aggregation has been removed

The `missing` option of the `composite` aggregation, deprecated in 6.x,
has been removed. `missing_bucket` should be used instead.

==== Replaced `params._agg` with `state` context variable in scripted metric aggregations

The object used to share aggregation state between the scripts in a Scripted Metric
Aggregation is now a variable called `state` available in the script context, rather than
being provided via the `params` object as `params._agg`.

The old `params._agg` variable is still available as well.

==== Change GeoHashGrid.Bucket#getKey() to return a String instead of a GeoPoint

The aggregation bucket used to return a GeoPoint representing the bucket keys hash
value. This was not consistent with the Rest API output that represents the key simply
as the string value of the geohash. The Java API now also returns a String here which
can be converted to a point as needed by the client.
