[testenv="platinum"]

If your {ml} indices were created before {prev-major-version}, they
must be reindexed. You must close all {ml} jobs to reindex and upgrade.

If your {ml} indices were created in {prev-major-version}, you can:

* Opt to leave your {ml} jobs running during the upgrade. When you shut down an
{ml} node, its jobs automatically move to another node. This enables your jobs
to continue running during the upgrade, but puts increased load on the cluster.

* Use the <<ml-set-upgrade-mode,set upgrade mode API>> to temporarily halt the
tasks associated with your {ml} jobs and {dfeeds} and prevent new jobs from
opening:
+
--
[source,js]
--------------------------------------------------
POST _ml/set_upgrade_mode?enabled=true
--------------------------------------------------
// CONSOLE

When you disable upgrade mode, the jobs resume using the last model
state that was automatically saved. This reduces the overhead of running {ml}
jobs during the upgrade and is faster than explicitly stopping {dfeeds} and
closing jobs.
--

* Explicitly {stack-ov}/stopping-ml.html[stop all {dfeeds} and close all jobs].
This saves the model state at the time of closure. When you reopen the jobs,
they use the exact same model. However, saving the latest model state takes
longer than enabling upgrade mode, especially if you have a lot of jobs or jobs
with large model states.
