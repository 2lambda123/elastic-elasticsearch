[role="xpack"]
[testenv="platinum"]
[[ccr-put-auto-follow-pattern]]
=== Create Auto-Follow Pattern API
++++
<titleabbrev>Create Auto-Follow Pattern</titleabbrev>
++++

Creates an auto-follow pattern.

==== Description

This API creates a new collection of auto-follow patterns against the specified
remote cluster. Newly created indices on the remote cluster matching any of the specified
patterns will be automatically configured as follower indices.

==== Request

[source,js]
--------------------------------------------------
PUT /_ccr/auto_follow/<leader_cluster>
{
  "leader_cluster" : "<leader_cluster>",
  "leader_index_patterns" :
  [
    "<leader_index_pattern>"
  ],
  "follow_index_pattern" : "<follow_index_pattern>"
}
--------------------------------------------------
// CONSOLE
// TEST[setup:leader_cluster]
// TEST[s/<leader_cluster>/leader_cluster/]
// TEST[s/<leader_index_patterns>/leader_index*/]
// TEST[s/<follow_index_pattern>/{{leader_index}}-follower/]

Here, `<leader_cluster>` is the <<modules-remote-clusters,remote cluster>>
containing the leader indices to match against, `<leader_index_pattern>` is a
simple index pattern to match against indices in the remote cluster, and
`<follow_index_pattern>` is the pattern to use to name the resulting follower
indices. The `<follow_index_pattern>` can use the template `{{leader_index}}` to
refer to the name of the leader index being followed.

==== Request Body
`leader_cluster`::
  (required string) the <<modules-remote-clusters,remote cluster>> containing the
  leader indices to match against

`leader_index_patterns`::
  (array) an array of simple index patterns to match against indices in the
  remote cluster specified by the `leader_cluster` field

`follow_index_pattern`::
  (string) the name of follower index; the template `{{leader_index}}` can be
  used to derive the name of the follower index from the name of the leader
  index

include::../follow-request-body.asciidoc[]

==== Example

The following is an example of using the create auto-follow pattern API.

[source,js]
--------------------------------------------------
PUT /_ccr/auto_follow/leader_cluster
{
  "leader_cluster" : "leader_cluster",
  "leader_index_patterns" :
  [
    "leader_index*"
  ],
  "follow_index_pattern" : "{{leader_index}}-follower"
}
--------------------------------------------------
// CONSOLE
// TEST[setup:leader_cluster]

The API returns the following result:

[source,js]
--------------------------------------------------
{
  "acknowledged" : true
}
--------------------------------------------------
// TESTRESPONSE

//////////////////////////

[source,js]
--------------------------------------------------
DELETE /_ccr/auto_follow/leader_cluster
--------------------------------------------------
// CONSOLE
// TEST[continued]

//////////////////////////
