---
setup:
  - do:
      raw:
        method: PUT
        path: "_scripts/my-search-template"
        body: |
          {
            "script": {
              "lang": "mustache",
              "source": {
                "query": {
                  "match": {
                    "message": "{{query_string}}"
                  }
                },
                "from": "{{from}}",
                "size": "{{size}}"
              },
              "params": {
                "query_string": "My query string"
              }
            }
          }
  - do:
      raw:
        method: PUT
        path: "my-index/_doc/1"
        refresh: ""
        body: |
          {
            "message": "hello world"
          }
---
"line_40":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: GET
        path: "my-index/_search/template"
        body: |
          {
            "id": "my-search-template",
            "params": {
              "query_string": "hello world",
              "from": 0,
              "size": 10
            }
          }
  - is_false: _shards.failures
