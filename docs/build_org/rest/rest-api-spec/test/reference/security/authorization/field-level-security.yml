---
"line_18":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/role/test_role1"
        body: |
          {
            "indices": [
              {
                "names": [ "events-*" ],
                "privileges": [ "read" ],
                "field_security" : {
                  "grant" : [ "category", "@timestamp", "message" ]
                }
              }
            ]
          }
  - is_false: _shards.failures
---
"line_43":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/role/test_role2"
        body: |
          {
            "indices" : [
              {
                "names" : [ "*" ],
                "privileges" : [ "read" ],
                "field_security" : {
                  "grant" : [ "event_*" ]
                }
              }
            ]
          }
  - is_false: _shards.failures
---
"line_77":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/role/test_role3"
        body: |
          {
            "indices" : [
              {
                "names" : [ "*" ],
                "privileges" : [ "read" ],
                "field_security" : {
                  "grant" : [ "customer.handle" ]
                }
              }
            ]
          }
  - is_false: _shards.failures
---
"line_96":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/role/test_role4"
        body: |
          {
            "indices" : [
              {
                "names" : [ "*" ],
                "privileges" : [ "read" ],
                "field_security" : {
                  "grant" : [ "customer.*" ]
                }
              }
            ]
          }
  - is_false: _shards.failures
---
"line_114":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/role/test_role5"
        body: |
          {
            "indices" : [
              {
                "names" : [ "*" ],
                "privileges" : [ "read" ],
                "field_security" : {
                  "grant" : [ "*"],
                  "except": [ "customer.handle" ]
                }
              }
            ]
          }
  - is_false: _shards.failures
---
"line_142":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/role/test_role6"
        body: |
          {
            "indices" : [
              {
                "names" : [ "*" ],
                "privileges" : [ "read" ],
                "field_security" : {
                  "except": [ "customer.handle" ],
                  "grant" : [ "customer.*" ]
                }
              }
            ]
          }
  - is_false: _shards.failures
---
"line_169":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/role/test_role7"
        body: |
          {
            "indices" : [
              {
                "names" : [ "*" ],
                "privileges" : [ "read" ],
                "field_security" : {
                  "grant": [ "a.*" ],
                  "except" : [ "a.b*" ]
                }
              }
            ]
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: POST
        path: "_security/role/test_role8"
        body: |
          {
            "indices" : [
              {
                "names" : [ "*" ],
                "privileges" : [ "read" ],
                "field_security" : {
                  "grant": [ "a.b*" ],
                  "except" : [ "a.b.c*" ]
                }
              }
            ]
          }
  - is_false: _shards.failures
