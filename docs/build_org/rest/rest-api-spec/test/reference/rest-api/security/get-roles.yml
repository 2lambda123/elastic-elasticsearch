---
"line_55":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
# Named setup admin_role

  - do:
      security.put_role:
        name: "my_admin_role"
        body: >
          {
            "cluster": ["all"],
            "indices": [
              {"names": ["index1", "index2" ], "privileges": ["all"], "field_security" : {"grant" : [ "title", "body" ]}}
              ],
            "run_as": [ "other_user" ],
            "metadata" : {"version": 1}
          }

  - do:
      raw:
        method: GET
        path: "_security/role/my_admin_role"
  - is_false: _shards.failures
  - match:
      $body:
        {
          "my_admin_role": {
            "cluster" : [ "all" ],
            "indices" : [
              {
                "names" : [ "index1", "index2" ],
                "privileges" : [ "all" ],
                "allow_restricted_indices" : false,
                "field_security" : {
                  "grant" : [ "title", "body" ]}
              }
            ],
            "applications" : [ ],
            "run_as" : [ "other_user" ],
            "metadata" : {
              "version" : 1
            },
            "transient_metadata": {
              "enabled": true
            }
          }
        }
  - do:
      raw:
        method: GET
        path: "_security/role"
  - is_false: _shards.failures
