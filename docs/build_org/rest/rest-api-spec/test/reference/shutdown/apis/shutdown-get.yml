---
"line_51":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: PUT
        path: "_nodes/USpTGYaBSIKbgSUJR2Z9lg/shutdown"
        body: |
          {
            "type": "restart",
            "reason": "Demonstrating how the node shutdown API works",
            "allocation_delay": "10m"
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "_nodes/USpTGYaBSIKbgSUJR2Z9lg/shutdown"
  - is_false: _shards.failures
  - match:
      $body:
        {
            "nodes": [
                {
                    "node_id": "$body.nodes.0.node_id",
                    "type": "RESTART",
                    "reason": "Demonstrating how the node shutdown API works",
                    "shutdown_startedmillis": $body.nodes.0.shutdown_startedmillis,
                    "allocation_delay": "10m",
                    "status": "COMPLETE",
                    "shard_migration": {
                        "status": "COMPLETE",
                        "shard_migrations_remaining": 0,
                        "explanation": "no shard relocation is necessary for a node restart"
                    },
                    "persistent_tasks": {
                        "status": "COMPLETE"
                    },
                    "plugins": {
                        "status": "COMPLETE"
                    }
                }
            ]
        }
