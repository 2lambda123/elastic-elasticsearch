---
"line_72":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/oidc/prepare"
        body: |
          {
            "realm" : "oidc1"
          }
  - is_false: _shards.failures
  - match:
      $body:
        {
          "redirect" : "${body.redirect}",
          "state" : "${body.state}",
          "nonce" : "${body.nonce}",
          "realm" : "oidc1"
        }
---
"line_100":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/oidc/prepare"
        body: |
          {
            "realm" : "oidc1",
            "state" : "lGYK0EcSLjqH6pkT5EVZjC6eIW5YCGgywj2sxROO",
            "nonce" : "zOBXLJGUooRrbLbQk5YCcyC8AXw3iloynvluYhZ5"
          }
  - is_false: _shards.failures
  - match:
      $body:
        {
          "redirect" : "${body.redirect}",
          "state" : "lGYK0EcSLjqH6pkT5EVZjC6eIW5YCGgywj2sxROO",
          "nonce" : "zOBXLJGUooRrbLbQk5YCcyC8AXw3iloynvluYhZ5",
          "realm" : "oidc1"
        }
---
"line_128":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/oidc/prepare"
        body: |
          {
            "iss" : "http://127.0.0.1:8080",
            "login_hint": "this_is_an_opaque_string"
          }
  - is_false: _shards.failures
  - match:
      $body:
        {
          "redirect" : "http://127.0.0.1:8080/c2id-login?login_hint=this_is_an_opaque_string&scope=openid&response_type=id_token&redirect_uri=https%3A%2F%2Fmy.fantastic.rp%2Fcb&state=${body.state}&nonce=${body.nonce}&client_id=elasticsearch-rp",
          "state" : "${body.state}",
          "nonce" : "${body.nonce}",
          "realm" : "oidc1"
        }
