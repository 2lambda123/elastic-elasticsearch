---
"line_92":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/api_key"
        body: |
          {
            "name": "my-api-key",
            "role_descriptors": {},
            "metadata": {
              "application": "myapp"
            }
          }
  - is_false: _shards.failures
  - match:
      $body:
        {
          "id":"$body.id",
          "name":"my-api-key",
          "api_key":"$body.api_key",
          "encoded": "$body.encoded"
        }
  - do:
      raw:
        method: GET
        path: "_security/api_key"
        id: "$body.id"
        with_limited_by: "true"
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "_security/api_key"
        name: "my-api-key"
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "_security/api_key"
        name: "my-*"
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "_security/api_key"
        realm_name: "native1"
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "_security/api_key"
        username: "myuser"
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "_security/api_key"
        owner: "true"
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "_security/api_key"
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "_security/api_key"
        active_only: "true"
  - is_false: _shards.failures
---
"line_255":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/api_key"
        body: |
          {
            "name": "my-api-key-1",
            "metadata": {
              "application": "my-application"
            }
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "_security/api_key"
        id: "$body.id"
        owner: "true"
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "_security/api_key"
        username: "myuser"
        realm_name: "native1"
  - is_false: _shards.failures
