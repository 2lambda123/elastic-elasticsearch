---
"line_104":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/role/my_admin_role"
        body: |
          {
            "cluster": ["all"],
            "indices": [
              {
                "names": [ "index1", "index2" ],
                "privileges": ["all"],
                "field_security" : { // optional
                  "grant" : [ "title", "body" ]
                },
                "query": "{\"match\": {\"title\": \"foo\"}}" // optional
              }
            ],
            "applications": [
              {
                "application": "myapp",
                "privileges": [ "admin", "read" ],
                "resources": [ "*" ]
              }
            ],
            "run_as": [ "other_user" ], // optional
            "metadata" : { // optional
              "version" : 1
            }
          }
  - is_false: _shards.failures
  - match:
      $body:
        {
          "role": {
            "created": true
          }
        }
---
"line_150":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/role/cli_or_drivers_minimal"
        body: |
          {
            "cluster": ["cluster:monitor/main"],
            "indices": [
              {
                "names": ["test"],
                "privileges": ["read", "indices:admin/get"]
              }
            ]
          }
  - is_false: _shards.failures
---
"line_166":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/role/role_with_remote_indices"
        body: |
          {
            "remote_indices": [
              {
                "clusters": [ "my_remote" ],
                "names": ["logs*"],
                "privileges": ["read", "read_cross_cluster", "view_index_metadata"]
              }
            ]
          }
  - is_false: _shards.failures
