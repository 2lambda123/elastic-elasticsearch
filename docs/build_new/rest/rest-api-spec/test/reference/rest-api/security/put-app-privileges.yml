---
"line_88":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: PUT
        path: "_security/privilege"
        body: |
          {
            "myapp": {
              "read": {
                "actions": [
                  "data:read/*" ,
                  "action:login" ],
                  "metadata": {
                    "description": "Read access to myapp"
                  }
                }
              }
          }
  - is_false: _shards.failures
  - match:
      $body:
        {
          "myapp": {
            "read": {
              "created": true
            }
          }
        }
---
"line_130":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: PUT
        path: "_security/privilege"
        body: |
          {
            "app01": {
              "read": {
                "actions": [ "action:login", "data:read/*" ]
              },
              "write": {
                "actions": [ "action:login", "data:write/*" ]
              }
            },
            "app02": {
              "all": {
                "actions": [ "*" ]
              }
            }
          }
  - is_false: _shards.failures
  - match:
      $body:
        {
          "app02": {
            "all": {
              "created": true
            }
          },
          "app01": {
            "read": {
              "created": true
            },
            "write": {
              "created": true
            }
          }
        }
