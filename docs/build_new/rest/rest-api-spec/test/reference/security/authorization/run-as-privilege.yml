---
"line_51":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/role/my_director"
        refresh: "true"
        body: |
          {
            "cluster": ["manage"],
            "indices": [
              {
                "names": [ "index1", "index2" ],
                "privileges": [ "manage" ]
              }
            ],
            "run_as": [ "jacknich", "rdeniro" ],
            "metadata" : {
              "version" : 1
            }
          }
  - is_false: _shards.failures
---
"line_114":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/role/my_admin_role"
        refresh: "true"
        body: |
          {
            "cluster": ["manage"],
            "indices": [
              {
                "names": [ "index1", "index2" ],
                "privileges": [ "manage" ]
              }
            ],
            "applications": [
              {
                "application": "myapp",
                "privileges": [ "admin", "read" ],
                "resources": [ "*" ]
              }
            ],
            "run_as": [ "analyst_user" ],
            "metadata" : {
              "version" : 1
            }
          }
  - is_false: _shards.failures
---
"line_143":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/role/my_analyst_role"
        refresh: "true"
        body: |
          {
            "cluster": [ "monitor"],
            "indices": [
              {
                "names": [ "index1", "index2" ],
                "privileges": ["manage"]
              }
            ],
            "applications": [
              {
                "application": "myapp",
                "privileges": [ "read" ],
                "resources": [ "*" ]
              }
            ],
            "metadata" : {
              "version" : 1
            }
          }
  - is_false: _shards.failures
---
"line_170":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/user/admin_user"
        refresh: "true"
        body: |
          {
            "password": "l0ng-r4nd0m-p@ssw0rd",
            "roles": [ "my_admin_role" ],
            "full_name": "Eirian Zola",
            "metadata": { "intelligence" : 7}
          }
  - is_false: _shards.failures
---
"line_184":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: POST
        path: "_security/user/analyst_user"
        refresh: "true"
        body: |
          {
            "password": "l0nger-r4nd0mer-p@ssw0rd",
            "roles": [ "my_analyst_role" ],
            "full_name": "Monday Jaffe",
            "metadata": { "innovation" : 8}
          }
  - is_false: _shards.failures
