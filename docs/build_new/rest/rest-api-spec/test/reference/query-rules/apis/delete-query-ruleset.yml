---
setup:
  - do:
      raw:
        method: PUT
        path: "_query_rules/my-ruleset"
        body: |
          {
              "rules": [
                  {
                      "rule_id": "my-rule1",
                      "type": "pinned",
                      "criteria": [
                          {
                              "type": "exact",
                              "metadata": "query_string",
                              "values": [ "marvel" ]
                          }
                      ],
                      "actions": {
                          "ids": ["id1"]
                      }
                  }
              ]
          }
---
"line_71":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: DELETE
        path: "_query_rules/my-ruleset/"
  - is_false: _shards.failures
