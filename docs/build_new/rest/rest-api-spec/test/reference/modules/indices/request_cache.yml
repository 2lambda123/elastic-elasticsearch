---
"line_47":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: PUT
        path: "my-index-000001"
  - is_false: _shards.failures
  - do:
      raw:
        method: PUT
        path: "my-index-000002"
  - is_false: _shards.failures
  - do:
      raw:
        method: POST
        path: "my-index-000001,my-index-000002/_cache/clear"
        request: "true"
  - is_false: _shards.failures
---
"line_59":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: PUT
        path: "my-index-000001"
        body: |
          {
            "settings": {
              "index.requests.cache.enable": false
            }
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: PUT
        path: "my-index-000001/_settings"
        body: |
          { "index.requests.cache.enable": true }
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "my-index-000001/_search"
        request_cache: "true"
        body: |
          {
            "size": 0,
            "aggs": {
              "popular_colors": {
                "terms": {
                  "field": "colors"
                }
              }
            }
          }
  - is_false: _shards.failures
---
"line_139":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: GET
        path: "_stats/request_cache"
        human: ""
  - is_false: _shards.failures
---
"line_146":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: GET
        path: "_nodes/stats/indices/request_cache"
        human: ""
  - is_false: _shards.failures
