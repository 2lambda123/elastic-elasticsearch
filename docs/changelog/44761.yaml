pr: 44761
issues:
  - 43102
area: Engine
type: breaking, bug
summary: Force Merge should reject requests with `only_expunge_deletes` and
  `max_num_segments` set
versions:
  - v8.0.0
breaking:
  notable: false
  title: Force Merge should reject requests with `only_expunge_deletes` and
    `max_num_segments` set
  anchor: force_merge_should_reject_requests_with_only_expunge_deletes_and_max_num_segments_set
  body: >-
    This pull request changes the `ForceMergeRequest.validate()` method so that
    it does not accept the parameters `only_expunge_deletes` and
    `max_num_segments` to be set at the same time. 

    The motivation is that `InternalEngine.forceMerge()` just ignores the max. number of segments parameter when the only expunge parameter is set to true, leaving the wrong impression to the user that max. number of segments has been applied. This PR also changes `InternalEngine.forceMerge()` so that it now throws an exception when both parameters are set, and modifies tests where needed.

    Because it changes the behavior of the REST API I marked this as `>breaking`. Once this is merged I'll open a follow up PR to add deprecation logging in 7.x.

    Closes  #43102
