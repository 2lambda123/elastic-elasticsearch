[[painless-min-should-match-context]]
=== Minimum should match context

Use a Painless script to specify the
{ref}/query-dsl-terms-set-query.html[minimum] number of terms that a
specified field needs to match with for a document to be part of the query
results.

*Variables*

`params` (`Map`, read-only)::
        User-defined parameters passed in as part of the query.

`params['num_terms']` (`int`, read-only)::
        The number of terms specified to match with.

`doc` (`Map`, read-only)::
        Contains the fields of the current document where each field is a
        `List` of values.

*Return*

`int`::
        The minimum number of terms required to match the current document.

*API*

The standard <<painless-api-reference, Painless API>> is available.

*Example*

To run this example, first follow the steps in
<<painless-context-examples, context examples>>.

Imagine that you want to find seats to performances where your favorite
actors play. You have a list of favorite actors in mind, and you want
to find performances that have at least certain minimum number of actors
from your favorite list. `terms_set` query with
`minimum_should_match_script` is a way to accomplish this. To make
the query request more configurable, you can define
`min_actors_to_see` as a script parameter.

To ensure that `min_actors_to_see` parameter doesn't exceed the number
your favorite actors, use the script below. This script
selects the minimum value between the parameter `min_actors_to_see` and
the parameter `num_terms`, which represents the length of the list of
your favorite actors.

[source,Painless]
----
Math.min(params['num_terms'], params['min_actors_to_see'])
----

Submit the following request to find seats to performances with your favorite actors:

[source,js]
----
GET seats/_search
{
    "query" : {
        "terms_set": {
            "actors" : {
                "terms" : ["smith", "earns", "black"],
                "minimum_should_match_script": {
                    "source": "Math.min(params['num_terms'], params['min_actors_to_see'])",
                    "params" : {
                        "min_actors_to_see" : 2
                    }
                }
            }
        }
    }
}
----
// CONSOLE
// TEST[skip: requires setup from other pages]

