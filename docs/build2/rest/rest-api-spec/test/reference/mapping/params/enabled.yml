---
"line_17":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: PUT
        path: "my-index-000001"
        body: |
          {
            "mappings": {
              "properties": {
                "user_id": {
                  "type":  "keyword"
                },
                "last_updated": {
                  "type": "date"
                },
                "session_data": {
                  "type": "object",
                  "enabled": false
                }
              }
            }
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: PUT
        path: "my-index-000001/_doc/session_1"
        body: |
          {
            "user_id": "kimchy",
            "session_data": {
              "arbitrary_object": {
                "some_array": [ "foo", "bar", { "baz": 2 } ]
              }
            },
            "last_updated": "2015-12-06T18:20:22"
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: PUT
        path: "my-index-000001/_doc/session_2"
        body: |
          {
            "user_id": "jpountz",
            "session_data": "none",
            "last_updated": "2015-12-06T18:22:13"
          }
  - is_false: _shards.failures
---
"line_64":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: PUT
        path: "my-index-000001"
        body: |
          {
            "mappings": {
              "enabled": false
            }
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: PUT
        path: "my-index-000001/_doc/session_1"
        body: |
          {
            "user_id": "kimchy",
            "session_data": {
              "arbitrary_object": {
                "some_array": [ "foo", "bar", { "baz": 2 } ]
              }
            },
            "last_updated": "2015-12-06T18:20:22"
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "my-index-000001/_doc/session_1"
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "my-index-000001/_mapping"
  - is_false: _shards.failures
---
"line_99":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: PUT
        path: "my-index-000001"
        body: |
          {
            "mappings": {
              "properties": {
                "session_data": {
                  "type": "object",
                  "enabled": false
                }
              }
            }
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: PUT
        path: "my-index-000001/_doc/session_1"
        body: |
          {
            "session_data": "foo bar"
          }
  - is_false: _shards.failures
