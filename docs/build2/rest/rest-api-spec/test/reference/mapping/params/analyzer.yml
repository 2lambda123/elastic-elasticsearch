---
"line_38":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: PUT
        path: "my-index-000001"
        body: |
          {
             "settings":{
                "analysis":{
                   "analyzer":{
                      "my_analyzer":{
                         "type":"custom",
                         "tokenizer":"standard",
                         "filter":[
                            "lowercase"
                         ]
                      },
                      "my_stop_analyzer":{
                         "type":"custom",
                         "tokenizer":"standard",
                         "filter":[
                            "lowercase",
                            "english_stop"
                         ]
                      }
                   },
                   "filter":{
                      "english_stop":{
                         "type":"stop",
                         "stopwords":"_english_"
                      }
                   }
                }
             },
             "mappings":{
                 "properties":{
                    "title": {
                       "type":"text",
                       "analyzer":"my_analyzer",
                       "search_analyzer":"my_stop_analyzer",
                       "search_quote_analyzer":"my_analyzer"
                   }
                }
             }
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: PUT
        path: "my-index-000001/_doc/1"
        body: |
          {
             "title":"The Quick Brown Fox"
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: PUT
        path: "my-index-000001/_doc/2"
        body: |
          {
             "title":"A Quick Brown Fox"
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "my-index-000001/_search"
        body: |
          {
             "query":{
                "query_string":{
                   "query":"\"the quick brown fox\""
                }
             }
          }
  - is_false: _shards.failures
