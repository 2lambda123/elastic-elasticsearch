---
"line_21":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: HEAD
        path: "my-data-stream"
  - is_false: _shards.failures
---
"line_29":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: GET
        path: "_data_stream/_stats"
        human: "true"
  - is_false: _shards.failures
---
"line_37":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: GET
        path: "_all"
        filter_path: "*.aliases"
  - is_false: _shards.failures
---
"line_46":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: GET
        path: "my-alias/_search"
        ignore_unavailable: "true"
  - is_false: _shards.failures
---
"line_63":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: PUT
        path: "my-index-000001"
        body: |
          {
            "mappings": {
              "properties": {
                "@timestamp": {
                  "type": "date"
                },
                "my-field": {
                  "type": "keyword"
                },
                "my-num-field": {
                  "type": "integer"
                }
              }
            }
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "my-index-000001/_count"
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "my-index-000001/_field_caps"
        fields: "my-field"
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "my-index-000001/_mappings"
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "my-index-000001/_analyze"
        body: |
          {
            "field" : "my-field",
            "text" : "this is a test"
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "my-index-000001/_count"
        body: |
          {
            "query": {
              "exists": {
                "field": "my-field"
              }
            }
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "my-index-000001/_search"
        filter_path: "aggregations"
        body: |
          {
            "size": 0,
            "aggs": {
              "top_values": {
                "terms": {
                  "field": "my-field",
                  "size": 10
                }
              }
            }
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "my-index-000001/_search"
        filter_path: "aggregations"
        body: |
          {
            "aggs": {
              "my-num-field-stats": {
                "stats": {
                  "field": "my-num-field"
                }
              }
            }
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "my-index-000001/_search"
        sort: "@timestamp:desc"
        size: "1"
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "my-index-000001/_validate/query"
        rewrite: "true"
        body: |
          {
            "query": {
              "match": {
                "user.id": {
                  "query": "kimchy",
                  "fuzziness": "auto"
                }
              }
            }
          }
  - is_false: _shards.failures
---
"line_276":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
# Named setup messages

  - do:
        indices.create:
          index: my-index-000001
          body:
            settings:
              number_of_shards: 1
              number_of_replicas: 1
  - do:
        bulk:
          index: my-index-000001
          refresh: true
          body: |
            {"index":{"_id": "0"}}
            {"message": "trying out Elasticsearch", "context": "foo"}
            {"index":{"_id": "1"}}
            {"message": "some message with the number 1", "context": "bar"}
            {"index":{"_id": "2"}}
            {"message": "some message with the number 2", "context": "bar"}
            {"index":{"_id": "3"}}
            {"message": "some message with the number 3", "context": "bar"}
            {"index":{"_id": "4"}}
            {"message": "some message with the number 4", "context": "bar"}

  - do:
      raw:
        method: GET
        path: "my-index-000001/_explain/0"
        body: |
          {
            "query" : {
              "match" : { "message" : "elasticsearch" }
            }
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "my-index-000001/_settings"
  - is_false: _shards.failures
