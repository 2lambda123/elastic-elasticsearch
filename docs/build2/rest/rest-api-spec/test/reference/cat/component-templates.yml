---
"line_63":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: PUT
        path: "_component_template/my-template-1"
        body: |
          {
            "template": {
              "settings": {
                "number_of_shards": 1
              }
            }
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: PUT
        path: "_component_template/my-template-2"
        body: |
          {
            "template": {
              "mappings": {
                "_source": {
                  "enabled": false
                },
                "properties": {
                  "host_name": {
                    "type": "keyword"
                  },
                  "created_at": {
                    "type": "date",
                    "format": "EEE MMM dd HH:mm:ss Z yyyy"
                  }
                }
              }
            }
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: PUT
        path: "_index_template/my-index-template"
        body: |
          {
            "index_patterns": [
              "my-index*"
            ],
            "composed_of": [
              "my-template-1",
              "my-template-2"
            ]
          }
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "_cat/component_templates/my-template-*"
        v: "true"
        s: "name"
  - match:
      $body:
        /name          \s+version \s+alias_count \s+mapping_count \s+settings_count \s+metadata_count \s+included_in\s*
         my-template-1         \s+0           \s+0             \s+1              \s+0              \s+\[my-index-template\]\s*
         my-template-2         \s+0           \s+3             \s+0              \s+0              \s+\[my-index-template\]\s*/
  - do:
      raw:
        method: DELETE
        path: "_index_template/my-index-template"
  - is_false: _shards.failures
  - do:
      raw:
        method: DELETE
        path: "_component_template/my-template-1"
  - is_false: _shards.failures
  - do:
      raw:
        method: DELETE
        path: "_component_template/my-template-2"
  - is_false: _shards.failures
