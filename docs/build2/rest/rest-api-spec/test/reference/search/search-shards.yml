---
"line_10":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: PUT
        path: "my-index-000001"
        body: |
          {"settings":{"index.number_of_shards":5}}
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "my-index-000001/_search_shards"
  - is_false: _shards.failures
---
"line_71":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: PUT
        path: "my-index-000001"
        body: |
          {"settings":{"index.number_of_shards":5}}
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "my-index-000001/_search_shards"
  - is_false: _shards.failures
  - match:
      $body:
        {
          "nodes": $body.nodes,
          "indices" : {
            "my-index-000001": { }
          },
          "shards": [
            [
              {
                "index": "my-index-000001",
                "node": "$body.shards.0.0.node",
                "relocating_node": null,
                "primary": true,
                "shard": 0,
                "state": "STARTED",
                "allocation_id": {"id":"$body.shards.0.0.allocation_id.id"},
                "relocation_failure_info" : {
                  "failed_attempts" : 0
                }
              }
            ],
            [
              {
                "index": "my-index-000001",
                "node": "$body.shards.0.0.node",
                "relocating_node": null,
                "primary": true,
                "shard": 1,
                "state": "STARTED",
                "allocation_id": {"id":"$body.shards.1.0.allocation_id.id"},
                "relocation_failure_info" : {
                  "failed_attempts" : 0
                }
              }
            ],
            [
              {
                "index": "my-index-000001",
                "node": "$body.shards.0.0.node",
                "relocating_node": null,
                "primary": true,
                "shard": 2,
                "state": "STARTED",
                "allocation_id": {"id":"$body.shards.2.0.allocation_id.id"},
                "relocation_failure_info" : {
                  "failed_attempts" : 0
                }
              }
            ],
            [
              {
                "index": "my-index-000001",
                "node": "$body.shards.0.0.node",
                "relocating_node": null,
                "primary": true,
                "shard": 3,
                "state": "STARTED",
                "allocation_id": {"id":"$body.shards.3.0.allocation_id.id"},
                "relocation_failure_info" : {
                  "failed_attempts" : 0
                }
              }
            ],
            [
              {
                "index": "my-index-000001",
                "node": "$body.shards.0.0.node",
                "relocating_node": null,
                "primary": true,
                "shard": 4,
                "state": "STARTED",
                "allocation_id": {"id":"$body.shards.4.0.allocation_id.id"},
                "relocation_failure_info" : {
                  "failed_attempts" : 0
                }
              }
            ]
          ]
        }
---
"line_170":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: PUT
        path: "my-index-000001"
        body: |
          {"settings":{"index.number_of_shards":5}}
  - is_false: _shards.failures
  - do:
      raw:
        method: GET
        path: "my-index-000001/_search_shards"
        routing: "foo,bar"
  - is_false: _shards.failures
  - match:
      $body:
        {
          "nodes": $body.nodes,
          "indices" : {
              "my-index-000001": { }
          },
          "shards": [
            [
              {
                "index": "my-index-000001",
                "node": "$body.shards.1.0.node",
                "relocating_node": null,
                "primary": true,
                "shard": 2,
                "state": "STARTED",
                "allocation_id": {"id":"$body.shards.0.0.allocation_id.id"},
                "relocation_failure_info" : {
                  "failed_attempts" : 0
                }
              }
            ],
            [
              {
                "index": "my-index-000001",
                "node": "$body.shards.1.0.node",
                "relocating_node": null,
                "primary": true,
                "shard": 3,
                "state": "STARTED",
                "allocation_id": {"id":"$body.shards.1.0.allocation_id.id"},
                "relocation_failure_info" : {
                  "failed_attempts" : 0
                }
              }
            ]
          ]
        }
