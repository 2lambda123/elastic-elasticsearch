---
"line_69":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: GET
        path: "_security/user/_has_privileges"
        body: |
          {
            "cluster": [ "monitor", "manage" ],
            "index" : [
              {
                "names": [ "suppliers", "products" ],
                "privileges": [ "read" ]
              },
              {
                "names": [ "inventory" ],
                "privileges" : [ "read", "write" ]
              }
            ],
            "application": [
              {
                "application": "inventory_manager",
                "privileges" : [ "read", "data:write/inventory" ],
                "resources" : [ "product/1852563" ]
              }
            ]
          }
  - is_false: _shards.failures
  - match:
      $body:
        {
          "username": "$body.username",
          "has_all_requested" : true,
          "cluster" : {
            "monitor" : true,
            "manage" : true
          },
          "index" : {
            "suppliers" : {
              "read" : true
            },
            "products" : {
              "read" : true
            },
            "inventory" : {
              "read" : true,
              "write" : true
            }
          },
          "application" : {
            "inventory_manager" : {
              "product/1852563" : {
                "read": true,
                "data:write/inventory": true
              }
            }
          }
        }
