---
"line_30":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
        - always_skip
      reason: needs-licence
  - do:
      raw:
        method: PUT
        path: "_ml/anomaly_detectors/population"
        body: |
          {
            "description" : "Population analysis",
            "analysis_config" : {
              "bucket_span":"15m",
              "influencers": [
                "clientip"
              ],
              "detectors": [
                {
                  "function": "mean",
                  "field_name": "bytes",
                  "over_field_name": "clientip"
                }
              ]
            },
            "data_description" : {
              "time_field":"timestamp",
              "time_format": "epoch_ms"
            }
          }
  - is_false: _shards.failures
