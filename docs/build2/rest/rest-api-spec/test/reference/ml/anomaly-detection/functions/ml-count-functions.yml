---
"line_46":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
        - always_skip
      reason: needs-licence
  - do:
      raw:
        method: PUT
        path: "_ml/anomaly_detectors/example1"
        body: |
          {
            "analysis_config": {
              "detectors": [{
                "function" : "count"
              }]
            },
            "data_description": {
              "time_field":"timestamp",
              "time_format": "epoch_ms"
            }
          }
  - is_false: _shards.failures
---
"line_72":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
        - always_skip
      reason: needs-licence
  - do:
      raw:
        method: PUT
        path: "_ml/anomaly_detectors/example2"
        body: |
          {
            "analysis_config": {
              "detectors": [{
                "function" : "high_count",
                "by_field_name" : "error_code",
                "over_field_name": "user"
              }]
            },
            "data_description": {
              "time_field":"timestamp",
              "time_format": "epoch_ms"
            }
          }
  - is_false: _shards.failures
---
"line_97":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
        - always_skip
      reason: needs-licence
  - do:
      raw:
        method: PUT
        path: "_ml/anomaly_detectors/example3"
        body: |
          {
            "analysis_config": {
              "detectors": [{
                "function" : "low_count",
                "by_field_name" : "status_code"
              }]
            },
            "data_description": {
              "time_field":"timestamp",
              "time_format": "epoch_ms"
            }
          }
  - is_false: _shards.failures
---
"line_123":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
        - always_skip
      reason: needs-licence
  - do:
      raw:
        method: PUT
        path: "_ml/anomaly_detectors/example4"
        body: |
          {
            "analysis_config": {
              "summary_count_field_name" : "events_per_min",
              "detectors": [{
                "function" : "count"
              }]
            },
            "data_description": {
              "time_field":"timestamp",
              "time_format": "epoch_ms"
            }
          }
  - is_false: _shards.failures
---
"line_187":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
        - always_skip
      reason: needs-licence
  - do:
      raw:
        method: PUT
        path: "_ml/anomaly_detectors/example5"
        body: |
          {
            "analysis_config": {
              "detectors": [{
                "function" : "high_non_zero_count",
                "by_field_name" : "signaturename"
              }]
            },
            "data_description": {
              "time_field":"timestamp",
              "time_format": "epoch_ms"
            }
          }
  - is_false: _shards.failures
---
"line_240":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
        - always_skip
      reason: needs-licence
  - do:
      raw:
        method: PUT
        path: "_ml/anomaly_detectors/example6"
        body: |
          {
            "analysis_config": {
              "detectors": [{
                "function" : "distinct_count",
                "field_name" : "user"
              }]
            },
            "data_description": {
              "time_field":"timestamp",
              "time_format": "epoch_ms"
            }
          }
  - is_false: _shards.failures
---
"line_264":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
        - always_skip
      reason: needs-licence
  - do:
      raw:
        method: PUT
        path: "_ml/anomaly_detectors/example7"
        body: |
          {
            "analysis_config": {
              "detectors": [{
                "function" : "high_distinct_count",
                "field_name" : "dst_port",
                "over_field_name": "src_ip"
              }]
            },
            "data_description": {
              "time_field":"timestamp",
              "time_format": "epoch_ms"
            }
          }
  - is_false: _shards.failures
