---
"line_120":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
        - always_skip
      reason: TBD
  - do:
      raw:
        method: POST
        path: "_ml/data_frame/analytics/_explain"
        body: |
          {
            "source": {
              "index": "houses_sold_last_10_yrs"
            },
            "analysis": {
              "regression": {
                "dependent_variable": "price"
              }
            }
          }
  - is_false: _shards.failures
  - match:
      $body:
        {
          "field_selection": [
            {
              "field": "number_of_bedrooms",
              "mappings_types": ["integer"],
              "is_included": true,
              "is_required": false,
              "feature_type": "numerical"
            },
            {
              "field": "postcode",
              "mappings_types": ["text"],
              "is_included": false,
              "is_required": false,
              "reason": "[postcode.keyword] is preferred because it is aggregatable"
            },
            {
              "field": "postcode.keyword",
              "mappings_types": ["keyword"],
              "is_included": true,
              "is_required": false,
              "feature_type": "categorical"
            },
            {
              "field": "price",
              "mappings_types": ["float"],
              "is_included": true,
              "is_required": true,
              "feature_type": "numerical"
            }
          ],
          "memory_estimation": {
            "expected_memory_without_disk": "128MB",
            "expected_memory_with_disk": "32MB"
          }
        }
