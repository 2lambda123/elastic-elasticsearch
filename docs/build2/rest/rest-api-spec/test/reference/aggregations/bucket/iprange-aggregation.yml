---
"ip-range-example":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
# Named setup iprange

  - do:
        indices.create:
          index: ip_addresses
          body:
            settings:
              number_of_shards: 1
              number_of_replicas: 1
            mappings:
              properties:
                ip:
                  type: ip
  - do:
        bulk:
          index: ip_addresses
          refresh: true
          body: |
            {"index":{}}
            {"ip": "10.0.0.0"}
            {"index":{}}
            {"ip": "10.0.0.1"}
            {"index":{}}
            {"ip": "10.0.0.2"}
            {"index":{}}
            {"ip": "10.0.0.3"}
            {"index":{}}
            {"ip": "10.0.0.4"}
            {"index":{}}
            {"ip": "10.0.0.5"}
            {"index":{}}
            {"ip": "10.0.0.6"}
            {"index":{}}
            {"ip": "10.0.0.7"}
            {"index":{}}
            {"ip": "10.0.0.8"}
            {"index":{}}
            {"ip": "10.0.0.9"}
            {"index":{}}
            {"ip": "10.0.0.10"}
            {"index":{}}
            {"ip": "10.0.0.11"}
            {"index":{}}
            {"ip": "10.0.0.12"}
            {"index":{}}
            {"ip": "10.0.0.13"}
            {"index":{}}
            {"ip": "10.0.0.14"}
            {"index":{}}
            {"ip": "10.0.0.15"}
            {"index":{}}
            {"ip": "10.0.0.16"}
            {"index":{}}
            {"ip": "10.0.0.17"}
            {"index":{}}
            {"ip": "10.0.0.18"}
            {"index":{}}
            {"ip": "10.0.0.19"}
            {"index":{}}
            {"ip": "10.0.0.20"}
            {"index":{}}
            {"ip": "10.0.0.21"}
            {"index":{}}
            {"ip": "10.0.0.22"}
            {"index":{}}
            {"ip": "10.0.0.23"}
            {"index":{}}
            {"ip": "10.0.0.24"}
            {"index":{}}
            {"ip": "10.0.0.25"}
            {"index":{}}
            {"ip": "10.0.0.26"}
            {"index":{}}
            {"ip": "10.0.0.27"}
            {"index":{}}
            {"ip": "10.0.0.28"}
            {"index":{}}
            {"ip": "10.0.0.29"}
            {"index":{}}
            {"ip": "10.0.0.30"}
            {"index":{}}
            {"ip": "10.0.0.31"}
            {"index":{}}
            {"ip": "10.0.0.32"}
            {"index":{}}
            {"ip": "10.0.0.33"}
            {"index":{}}
            {"ip": "10.0.0.34"}
            {"index":{}}
            {"ip": "10.0.0.35"}
            {"index":{}}
            {"ip": "10.0.0.36"}
            {"index":{}}
            {"ip": "10.0.0.37"}
            {"index":{}}
            {"ip": "10.0.0.38"}
            {"index":{}}
            {"ip": "10.0.0.39"}
            {"index":{}}
            {"ip": "10.0.0.40"}
            {"index":{}}
            {"ip": "10.0.0.41"}
            {"index":{}}
            {"ip": "10.0.0.42"}
            {"index":{}}
            {"ip": "10.0.0.43"}
            {"index":{}}
            {"ip": "10.0.0.44"}
            {"index":{}}
            {"ip": "10.0.0.45"}
            {"index":{}}
            {"ip": "10.0.0.46"}
            {"index":{}}
            {"ip": "10.0.0.47"}
            {"index":{}}
            {"ip": "10.0.0.48"}
            {"index":{}}
            {"ip": "10.0.0.49"}
            {"index":{}}
            {"ip": "10.0.0.50"}
            {"index":{}}
            {"ip": "10.0.0.51"}
            {"index":{}}
            {"ip": "10.0.0.52"}
            {"index":{}}
            {"ip": "10.0.0.53"}
            {"index":{}}
            {"ip": "10.0.0.54"}
            {"index":{}}
            {"ip": "10.0.0.55"}
            {"index":{}}
            {"ip": "10.0.0.56"}
            {"index":{}}
            {"ip": "10.0.0.57"}
            {"index":{}}
            {"ip": "10.0.0.58"}
            {"index":{}}
            {"ip": "10.0.0.59"}
            {"index":{}}
            {"ip": "10.0.0.60"}
            {"index":{}}
            {"ip": "10.0.0.61"}
            {"index":{}}
            {"ip": "10.0.0.62"}
            {"index":{}}
            {"ip": "10.0.0.63"}
            {"index":{}}
            {"ip": "10.0.0.64"}
            {"index":{}}
            {"ip": "10.0.0.65"}
            {"index":{}}
            {"ip": "10.0.0.66"}
            {"index":{}}
            {"ip": "10.0.0.67"}
            {"index":{}}
            {"ip": "10.0.0.68"}
            {"index":{}}
            {"ip": "10.0.0.69"}
            {"index":{}}
            {"ip": "10.0.0.70"}
            {"index":{}}
            {"ip": "10.0.0.71"}
            {"index":{}}
            {"ip": "10.0.0.72"}
            {"index":{}}
            {"ip": "10.0.0.73"}
            {"index":{}}
            {"ip": "10.0.0.74"}
            {"index":{}}
            {"ip": "10.0.0.75"}
            {"index":{}}
            {"ip": "10.0.0.76"}
            {"index":{}}
            {"ip": "10.0.0.77"}
            {"index":{}}
            {"ip": "10.0.0.78"}
            {"index":{}}
            {"ip": "10.0.0.79"}
            {"index":{}}
            {"ip": "10.0.0.80"}
            {"index":{}}
            {"ip": "10.0.0.81"}
            {"index":{}}
            {"ip": "10.0.0.82"}
            {"index":{}}
            {"ip": "10.0.0.83"}
            {"index":{}}
            {"ip": "10.0.0.84"}
            {"index":{}}
            {"ip": "10.0.0.85"}
            {"index":{}}
            {"ip": "10.0.0.86"}
            {"index":{}}
            {"ip": "10.0.0.87"}
            {"index":{}}
            {"ip": "10.0.0.88"}
            {"index":{}}
            {"ip": "10.0.0.89"}
            {"index":{}}
            {"ip": "10.0.0.90"}
            {"index":{}}
            {"ip": "10.0.0.91"}
            {"index":{}}
            {"ip": "10.0.0.92"}
            {"index":{}}
            {"ip": "10.0.0.93"}
            {"index":{}}
            {"ip": "10.0.0.94"}
            {"index":{}}
            {"ip": "10.0.0.95"}
            {"index":{}}
            {"ip": "10.0.0.96"}
            {"index":{}}
            {"ip": "10.0.0.97"}
            {"index":{}}
            {"ip": "10.0.0.98"}
            {"index":{}}
            {"ip": "10.0.0.99"}
            {"index":{}}
            {"ip": "10.0.0.100"}
            {"index":{}}
            {"ip": "10.0.0.101"}
            {"index":{}}
            {"ip": "10.0.0.102"}
            {"index":{}}
            {"ip": "10.0.0.103"}
            {"index":{}}
            {"ip": "10.0.0.104"}
            {"index":{}}
            {"ip": "10.0.0.105"}
            {"index":{}}
            {"ip": "10.0.0.106"}
            {"index":{}}
            {"ip": "10.0.0.107"}
            {"index":{}}
            {"ip": "10.0.0.108"}
            {"index":{}}
            {"ip": "10.0.0.109"}
            {"index":{}}
            {"ip": "10.0.0.110"}
            {"index":{}}
            {"ip": "10.0.0.111"}
            {"index":{}}
            {"ip": "10.0.0.112"}
            {"index":{}}
            {"ip": "10.0.0.113"}
            {"index":{}}
            {"ip": "10.0.0.114"}
            {"index":{}}
            {"ip": "10.0.0.115"}
            {"index":{}}
            {"ip": "10.0.0.116"}
            {"index":{}}
            {"ip": "10.0.0.117"}
            {"index":{}}
            {"ip": "10.0.0.118"}
            {"index":{}}
            {"ip": "10.0.0.119"}
            {"index":{}}
            {"ip": "10.0.0.120"}
            {"index":{}}
            {"ip": "10.0.0.121"}
            {"index":{}}
            {"ip": "10.0.0.122"}
            {"index":{}}
            {"ip": "10.0.0.123"}
            {"index":{}}
            {"ip": "10.0.0.124"}
            {"index":{}}
            {"ip": "10.0.0.125"}
            {"index":{}}
            {"ip": "10.0.0.126"}
            {"index":{}}
            {"ip": "10.0.0.127"}
            {"index":{}}
            {"ip": "10.0.0.128"}
            {"index":{}}
            {"ip": "10.0.0.129"}
            {"index":{}}
            {"ip": "10.0.0.130"}
            {"index":{}}
            {"ip": "10.0.0.131"}
            {"index":{}}
            {"ip": "10.0.0.132"}
            {"index":{}}
            {"ip": "10.0.0.133"}
            {"index":{}}
            {"ip": "10.0.0.134"}
            {"index":{}}
            {"ip": "10.0.0.135"}
            {"index":{}}
            {"ip": "10.0.0.136"}
            {"index":{}}
            {"ip": "10.0.0.137"}
            {"index":{}}
            {"ip": "10.0.0.138"}
            {"index":{}}
            {"ip": "10.0.0.139"}
            {"index":{}}
            {"ip": "10.0.0.140"}
            {"index":{}}
            {"ip": "10.0.0.141"}
            {"index":{}}
            {"ip": "10.0.0.142"}
            {"index":{}}
            {"ip": "10.0.0.143"}
            {"index":{}}
            {"ip": "10.0.0.144"}
            {"index":{}}
            {"ip": "10.0.0.145"}
            {"index":{}}
            {"ip": "10.0.0.146"}
            {"index":{}}
            {"ip": "10.0.0.147"}
            {"index":{}}
            {"ip": "10.0.0.148"}
            {"index":{}}
            {"ip": "10.0.0.149"}
            {"index":{}}
            {"ip": "10.0.0.150"}
            {"index":{}}
            {"ip": "10.0.0.151"}
            {"index":{}}
            {"ip": "10.0.0.152"}
            {"index":{}}
            {"ip": "10.0.0.153"}
            {"index":{}}
            {"ip": "10.0.0.154"}
            {"index":{}}
            {"ip": "10.0.0.155"}
            {"index":{}}
            {"ip": "10.0.0.156"}
            {"index":{}}
            {"ip": "10.0.0.157"}
            {"index":{}}
            {"ip": "10.0.0.158"}
            {"index":{}}
            {"ip": "10.0.0.159"}
            {"index":{}}
            {"ip": "10.0.0.160"}
            {"index":{}}
            {"ip": "10.0.0.161"}
            {"index":{}}
            {"ip": "10.0.0.162"}
            {"index":{}}
            {"ip": "10.0.0.163"}
            {"index":{}}
            {"ip": "10.0.0.164"}
            {"index":{}}
            {"ip": "10.0.0.165"}
            {"index":{}}
            {"ip": "10.0.0.166"}
            {"index":{}}
            {"ip": "10.0.0.167"}
            {"index":{}}
            {"ip": "10.0.0.168"}
            {"index":{}}
            {"ip": "10.0.0.169"}
            {"index":{}}
            {"ip": "10.0.0.170"}
            {"index":{}}
            {"ip": "10.0.0.171"}
            {"index":{}}
            {"ip": "10.0.0.172"}
            {"index":{}}
            {"ip": "10.0.0.173"}
            {"index":{}}
            {"ip": "10.0.0.174"}
            {"index":{}}
            {"ip": "10.0.0.175"}
            {"index":{}}
            {"ip": "10.0.0.176"}
            {"index":{}}
            {"ip": "10.0.0.177"}
            {"index":{}}
            {"ip": "10.0.0.178"}
            {"index":{}}
            {"ip": "10.0.0.179"}
            {"index":{}}
            {"ip": "10.0.0.180"}
            {"index":{}}
            {"ip": "10.0.0.181"}
            {"index":{}}
            {"ip": "10.0.0.182"}
            {"index":{}}
            {"ip": "10.0.0.183"}
            {"index":{}}
            {"ip": "10.0.0.184"}
            {"index":{}}
            {"ip": "10.0.0.185"}
            {"index":{}}
            {"ip": "10.0.0.186"}
            {"index":{}}
            {"ip": "10.0.0.187"}
            {"index":{}}
            {"ip": "10.0.0.188"}
            {"index":{}}
            {"ip": "10.0.0.189"}
            {"index":{}}
            {"ip": "10.0.0.190"}
            {"index":{}}
            {"ip": "10.0.0.191"}
            {"index":{}}
            {"ip": "10.0.0.192"}
            {"index":{}}
            {"ip": "10.0.0.193"}
            {"index":{}}
            {"ip": "10.0.0.194"}
            {"index":{}}
            {"ip": "10.0.0.195"}
            {"index":{}}
            {"ip": "10.0.0.196"}
            {"index":{}}
            {"ip": "10.0.0.197"}
            {"index":{}}
            {"ip": "10.0.0.198"}
            {"index":{}}
            {"ip": "10.0.0.199"}
            {"index":{}}
            {"ip": "10.0.0.200"}
            {"index":{}}
            {"ip": "10.0.0.201"}
            {"index":{}}
            {"ip": "10.0.0.202"}
            {"index":{}}
            {"ip": "10.0.0.203"}
            {"index":{}}
            {"ip": "10.0.0.204"}
            {"index":{}}
            {"ip": "10.0.0.205"}
            {"index":{}}
            {"ip": "10.0.0.206"}
            {"index":{}}
            {"ip": "10.0.0.207"}
            {"index":{}}
            {"ip": "10.0.0.208"}
            {"index":{}}
            {"ip": "10.0.0.209"}
            {"index":{}}
            {"ip": "10.0.0.210"}
            {"index":{}}
            {"ip": "10.0.0.211"}
            {"index":{}}
            {"ip": "10.0.0.212"}
            {"index":{}}
            {"ip": "10.0.0.213"}
            {"index":{}}
            {"ip": "10.0.0.214"}
            {"index":{}}
            {"ip": "10.0.0.215"}
            {"index":{}}
            {"ip": "10.0.0.216"}
            {"index":{}}
            {"ip": "10.0.0.217"}
            {"index":{}}
            {"ip": "10.0.0.218"}
            {"index":{}}
            {"ip": "10.0.0.219"}
            {"index":{}}
            {"ip": "10.0.0.220"}
            {"index":{}}
            {"ip": "10.0.0.221"}
            {"index":{}}
            {"ip": "10.0.0.222"}
            {"index":{}}
            {"ip": "10.0.0.223"}
            {"index":{}}
            {"ip": "10.0.0.224"}
            {"index":{}}
            {"ip": "10.0.0.225"}
            {"index":{}}
            {"ip": "10.0.0.226"}
            {"index":{}}
            {"ip": "10.0.0.227"}
            {"index":{}}
            {"ip": "10.0.0.228"}
            {"index":{}}
            {"ip": "10.0.0.229"}
            {"index":{}}
            {"ip": "10.0.0.230"}
            {"index":{}}
            {"ip": "10.0.0.231"}
            {"index":{}}
            {"ip": "10.0.0.232"}
            {"index":{}}
            {"ip": "10.0.0.233"}
            {"index":{}}
            {"ip": "10.0.0.234"}
            {"index":{}}
            {"ip": "10.0.0.235"}
            {"index":{}}
            {"ip": "10.0.0.236"}
            {"index":{}}
            {"ip": "10.0.0.237"}
            {"index":{}}
            {"ip": "10.0.0.238"}
            {"index":{}}
            {"ip": "10.0.0.239"}
            {"index":{}}
            {"ip": "10.0.0.240"}
            {"index":{}}
            {"ip": "10.0.0.241"}
            {"index":{}}
            {"ip": "10.0.0.242"}
            {"index":{}}
            {"ip": "10.0.0.243"}
            {"index":{}}
            {"ip": "10.0.0.244"}
            {"index":{}}
            {"ip": "10.0.0.245"}
            {"index":{}}
            {"ip": "10.0.0.246"}
            {"index":{}}
            {"ip": "10.0.0.247"}
            {"index":{}}
            {"ip": "10.0.0.248"}
            {"index":{}}
            {"ip": "10.0.0.249"}
            {"index":{}}
            {"ip": "10.0.0.250"}
            {"index":{}}
            {"ip": "10.0.0.251"}
            {"index":{}}
            {"ip": "10.0.0.252"}
            {"index":{}}
            {"ip": "10.0.0.253"}
            {"index":{}}
            {"ip": "10.0.0.254"}
            {"index":{}}
            {"ip": "9.0.0.0"}
            {"index":{}}
            {"ip": "11.0.0.0"}
            {"index":{}}
            {"ip": "12.0.0.0"}
            {"index":{}}
            {"ip": "9.0.0.1"}
            {"index":{}}
            {"ip": "11.0.0.1"}
            {"index":{}}
            {"ip": "12.0.0.1"}
            {"index":{}}
            {"ip": "9.0.0.2"}
            {"index":{}}
            {"ip": "11.0.0.2"}
            {"index":{}}
            {"ip": "12.0.0.2"}
            {"index":{}}
            {"ip": "9.0.0.3"}
            {"index":{}}
            {"ip": "11.0.0.3"}
            {"index":{}}
            {"ip": "12.0.0.3"}
            {"index":{}}
            {"ip": "9.0.0.4"}
            {"index":{}}
            {"ip": "11.0.0.4"}
            {"index":{}}
            {"ip": "12.0.0.4"}
  - do:
      raw:
        method: GET
        path: "ip_addresses/_search"
        body: |
          {
            "size": 10,
            "aggs": {
              "ip_ranges": {
                "ip_range": {
                  "field": "ip",
                  "ranges": [
                    { "to": "10.0.0.5" },
                    { "from": "10.0.0.5" }
                  ]
                }
              }
            }
          }
  - is_false: _shards.failures
  - match:
      $body:
        {
          "took": $body.took,"timed_out": false,"_shards": $body._shards,"hits": $body.hits,
        
          "aggregations": {
            "ip_ranges": {
              "buckets": [
                {
                  "key": "*-10.0.0.5",
                  "to": "10.0.0.5",
                  "doc_count": 10
                },
                {
                  "key": "10.0.0.5-*",
                  "from": "10.0.0.5",
                  "doc_count": 260
                }
              ]
            }
          }
        }
---
"ip-range-cidr-example":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
# Named setup iprange

  - do:
        indices.create:
          index: ip_addresses
          body:
            settings:
              number_of_shards: 1
              number_of_replicas: 1
            mappings:
              properties:
                ip:
                  type: ip
  - do:
        bulk:
          index: ip_addresses
          refresh: true
          body: |
            {"index":{}}
            {"ip": "10.0.0.0"}
            {"index":{}}
            {"ip": "10.0.0.1"}
            {"index":{}}
            {"ip": "10.0.0.2"}
            {"index":{}}
            {"ip": "10.0.0.3"}
            {"index":{}}
            {"ip": "10.0.0.4"}
            {"index":{}}
            {"ip": "10.0.0.5"}
            {"index":{}}
            {"ip": "10.0.0.6"}
            {"index":{}}
            {"ip": "10.0.0.7"}
            {"index":{}}
            {"ip": "10.0.0.8"}
            {"index":{}}
            {"ip": "10.0.0.9"}
            {"index":{}}
            {"ip": "10.0.0.10"}
            {"index":{}}
            {"ip": "10.0.0.11"}
            {"index":{}}
            {"ip": "10.0.0.12"}
            {"index":{}}
            {"ip": "10.0.0.13"}
            {"index":{}}
            {"ip": "10.0.0.14"}
            {"index":{}}
            {"ip": "10.0.0.15"}
            {"index":{}}
            {"ip": "10.0.0.16"}
            {"index":{}}
            {"ip": "10.0.0.17"}
            {"index":{}}
            {"ip": "10.0.0.18"}
            {"index":{}}
            {"ip": "10.0.0.19"}
            {"index":{}}
            {"ip": "10.0.0.20"}
            {"index":{}}
            {"ip": "10.0.0.21"}
            {"index":{}}
            {"ip": "10.0.0.22"}
            {"index":{}}
            {"ip": "10.0.0.23"}
            {"index":{}}
            {"ip": "10.0.0.24"}
            {"index":{}}
            {"ip": "10.0.0.25"}
            {"index":{}}
            {"ip": "10.0.0.26"}
            {"index":{}}
            {"ip": "10.0.0.27"}
            {"index":{}}
            {"ip": "10.0.0.28"}
            {"index":{}}
            {"ip": "10.0.0.29"}
            {"index":{}}
            {"ip": "10.0.0.30"}
            {"index":{}}
            {"ip": "10.0.0.31"}
            {"index":{}}
            {"ip": "10.0.0.32"}
            {"index":{}}
            {"ip": "10.0.0.33"}
            {"index":{}}
            {"ip": "10.0.0.34"}
            {"index":{}}
            {"ip": "10.0.0.35"}
            {"index":{}}
            {"ip": "10.0.0.36"}
            {"index":{}}
            {"ip": "10.0.0.37"}
            {"index":{}}
            {"ip": "10.0.0.38"}
            {"index":{}}
            {"ip": "10.0.0.39"}
            {"index":{}}
            {"ip": "10.0.0.40"}
            {"index":{}}
            {"ip": "10.0.0.41"}
            {"index":{}}
            {"ip": "10.0.0.42"}
            {"index":{}}
            {"ip": "10.0.0.43"}
            {"index":{}}
            {"ip": "10.0.0.44"}
            {"index":{}}
            {"ip": "10.0.0.45"}
            {"index":{}}
            {"ip": "10.0.0.46"}
            {"index":{}}
            {"ip": "10.0.0.47"}
            {"index":{}}
            {"ip": "10.0.0.48"}
            {"index":{}}
            {"ip": "10.0.0.49"}
            {"index":{}}
            {"ip": "10.0.0.50"}
            {"index":{}}
            {"ip": "10.0.0.51"}
            {"index":{}}
            {"ip": "10.0.0.52"}
            {"index":{}}
            {"ip": "10.0.0.53"}
            {"index":{}}
            {"ip": "10.0.0.54"}
            {"index":{}}
            {"ip": "10.0.0.55"}
            {"index":{}}
            {"ip": "10.0.0.56"}
            {"index":{}}
            {"ip": "10.0.0.57"}
            {"index":{}}
            {"ip": "10.0.0.58"}
            {"index":{}}
            {"ip": "10.0.0.59"}
            {"index":{}}
            {"ip": "10.0.0.60"}
            {"index":{}}
            {"ip": "10.0.0.61"}
            {"index":{}}
            {"ip": "10.0.0.62"}
            {"index":{}}
            {"ip": "10.0.0.63"}
            {"index":{}}
            {"ip": "10.0.0.64"}
            {"index":{}}
            {"ip": "10.0.0.65"}
            {"index":{}}
            {"ip": "10.0.0.66"}
            {"index":{}}
            {"ip": "10.0.0.67"}
            {"index":{}}
            {"ip": "10.0.0.68"}
            {"index":{}}
            {"ip": "10.0.0.69"}
            {"index":{}}
            {"ip": "10.0.0.70"}
            {"index":{}}
            {"ip": "10.0.0.71"}
            {"index":{}}
            {"ip": "10.0.0.72"}
            {"index":{}}
            {"ip": "10.0.0.73"}
            {"index":{}}
            {"ip": "10.0.0.74"}
            {"index":{}}
            {"ip": "10.0.0.75"}
            {"index":{}}
            {"ip": "10.0.0.76"}
            {"index":{}}
            {"ip": "10.0.0.77"}
            {"index":{}}
            {"ip": "10.0.0.78"}
            {"index":{}}
            {"ip": "10.0.0.79"}
            {"index":{}}
            {"ip": "10.0.0.80"}
            {"index":{}}
            {"ip": "10.0.0.81"}
            {"index":{}}
            {"ip": "10.0.0.82"}
            {"index":{}}
            {"ip": "10.0.0.83"}
            {"index":{}}
            {"ip": "10.0.0.84"}
            {"index":{}}
            {"ip": "10.0.0.85"}
            {"index":{}}
            {"ip": "10.0.0.86"}
            {"index":{}}
            {"ip": "10.0.0.87"}
            {"index":{}}
            {"ip": "10.0.0.88"}
            {"index":{}}
            {"ip": "10.0.0.89"}
            {"index":{}}
            {"ip": "10.0.0.90"}
            {"index":{}}
            {"ip": "10.0.0.91"}
            {"index":{}}
            {"ip": "10.0.0.92"}
            {"index":{}}
            {"ip": "10.0.0.93"}
            {"index":{}}
            {"ip": "10.0.0.94"}
            {"index":{}}
            {"ip": "10.0.0.95"}
            {"index":{}}
            {"ip": "10.0.0.96"}
            {"index":{}}
            {"ip": "10.0.0.97"}
            {"index":{}}
            {"ip": "10.0.0.98"}
            {"index":{}}
            {"ip": "10.0.0.99"}
            {"index":{}}
            {"ip": "10.0.0.100"}
            {"index":{}}
            {"ip": "10.0.0.101"}
            {"index":{}}
            {"ip": "10.0.0.102"}
            {"index":{}}
            {"ip": "10.0.0.103"}
            {"index":{}}
            {"ip": "10.0.0.104"}
            {"index":{}}
            {"ip": "10.0.0.105"}
            {"index":{}}
            {"ip": "10.0.0.106"}
            {"index":{}}
            {"ip": "10.0.0.107"}
            {"index":{}}
            {"ip": "10.0.0.108"}
            {"index":{}}
            {"ip": "10.0.0.109"}
            {"index":{}}
            {"ip": "10.0.0.110"}
            {"index":{}}
            {"ip": "10.0.0.111"}
            {"index":{}}
            {"ip": "10.0.0.112"}
            {"index":{}}
            {"ip": "10.0.0.113"}
            {"index":{}}
            {"ip": "10.0.0.114"}
            {"index":{}}
            {"ip": "10.0.0.115"}
            {"index":{}}
            {"ip": "10.0.0.116"}
            {"index":{}}
            {"ip": "10.0.0.117"}
            {"index":{}}
            {"ip": "10.0.0.118"}
            {"index":{}}
            {"ip": "10.0.0.119"}
            {"index":{}}
            {"ip": "10.0.0.120"}
            {"index":{}}
            {"ip": "10.0.0.121"}
            {"index":{}}
            {"ip": "10.0.0.122"}
            {"index":{}}
            {"ip": "10.0.0.123"}
            {"index":{}}
            {"ip": "10.0.0.124"}
            {"index":{}}
            {"ip": "10.0.0.125"}
            {"index":{}}
            {"ip": "10.0.0.126"}
            {"index":{}}
            {"ip": "10.0.0.127"}
            {"index":{}}
            {"ip": "10.0.0.128"}
            {"index":{}}
            {"ip": "10.0.0.129"}
            {"index":{}}
            {"ip": "10.0.0.130"}
            {"index":{}}
            {"ip": "10.0.0.131"}
            {"index":{}}
            {"ip": "10.0.0.132"}
            {"index":{}}
            {"ip": "10.0.0.133"}
            {"index":{}}
            {"ip": "10.0.0.134"}
            {"index":{}}
            {"ip": "10.0.0.135"}
            {"index":{}}
            {"ip": "10.0.0.136"}
            {"index":{}}
            {"ip": "10.0.0.137"}
            {"index":{}}
            {"ip": "10.0.0.138"}
            {"index":{}}
            {"ip": "10.0.0.139"}
            {"index":{}}
            {"ip": "10.0.0.140"}
            {"index":{}}
            {"ip": "10.0.0.141"}
            {"index":{}}
            {"ip": "10.0.0.142"}
            {"index":{}}
            {"ip": "10.0.0.143"}
            {"index":{}}
            {"ip": "10.0.0.144"}
            {"index":{}}
            {"ip": "10.0.0.145"}
            {"index":{}}
            {"ip": "10.0.0.146"}
            {"index":{}}
            {"ip": "10.0.0.147"}
            {"index":{}}
            {"ip": "10.0.0.148"}
            {"index":{}}
            {"ip": "10.0.0.149"}
            {"index":{}}
            {"ip": "10.0.0.150"}
            {"index":{}}
            {"ip": "10.0.0.151"}
            {"index":{}}
            {"ip": "10.0.0.152"}
            {"index":{}}
            {"ip": "10.0.0.153"}
            {"index":{}}
            {"ip": "10.0.0.154"}
            {"index":{}}
            {"ip": "10.0.0.155"}
            {"index":{}}
            {"ip": "10.0.0.156"}
            {"index":{}}
            {"ip": "10.0.0.157"}
            {"index":{}}
            {"ip": "10.0.0.158"}
            {"index":{}}
            {"ip": "10.0.0.159"}
            {"index":{}}
            {"ip": "10.0.0.160"}
            {"index":{}}
            {"ip": "10.0.0.161"}
            {"index":{}}
            {"ip": "10.0.0.162"}
            {"index":{}}
            {"ip": "10.0.0.163"}
            {"index":{}}
            {"ip": "10.0.0.164"}
            {"index":{}}
            {"ip": "10.0.0.165"}
            {"index":{}}
            {"ip": "10.0.0.166"}
            {"index":{}}
            {"ip": "10.0.0.167"}
            {"index":{}}
            {"ip": "10.0.0.168"}
            {"index":{}}
            {"ip": "10.0.0.169"}
            {"index":{}}
            {"ip": "10.0.0.170"}
            {"index":{}}
            {"ip": "10.0.0.171"}
            {"index":{}}
            {"ip": "10.0.0.172"}
            {"index":{}}
            {"ip": "10.0.0.173"}
            {"index":{}}
            {"ip": "10.0.0.174"}
            {"index":{}}
            {"ip": "10.0.0.175"}
            {"index":{}}
            {"ip": "10.0.0.176"}
            {"index":{}}
            {"ip": "10.0.0.177"}
            {"index":{}}
            {"ip": "10.0.0.178"}
            {"index":{}}
            {"ip": "10.0.0.179"}
            {"index":{}}
            {"ip": "10.0.0.180"}
            {"index":{}}
            {"ip": "10.0.0.181"}
            {"index":{}}
            {"ip": "10.0.0.182"}
            {"index":{}}
            {"ip": "10.0.0.183"}
            {"index":{}}
            {"ip": "10.0.0.184"}
            {"index":{}}
            {"ip": "10.0.0.185"}
            {"index":{}}
            {"ip": "10.0.0.186"}
            {"index":{}}
            {"ip": "10.0.0.187"}
            {"index":{}}
            {"ip": "10.0.0.188"}
            {"index":{}}
            {"ip": "10.0.0.189"}
            {"index":{}}
            {"ip": "10.0.0.190"}
            {"index":{}}
            {"ip": "10.0.0.191"}
            {"index":{}}
            {"ip": "10.0.0.192"}
            {"index":{}}
            {"ip": "10.0.0.193"}
            {"index":{}}
            {"ip": "10.0.0.194"}
            {"index":{}}
            {"ip": "10.0.0.195"}
            {"index":{}}
            {"ip": "10.0.0.196"}
            {"index":{}}
            {"ip": "10.0.0.197"}
            {"index":{}}
            {"ip": "10.0.0.198"}
            {"index":{}}
            {"ip": "10.0.0.199"}
            {"index":{}}
            {"ip": "10.0.0.200"}
            {"index":{}}
            {"ip": "10.0.0.201"}
            {"index":{}}
            {"ip": "10.0.0.202"}
            {"index":{}}
            {"ip": "10.0.0.203"}
            {"index":{}}
            {"ip": "10.0.0.204"}
            {"index":{}}
            {"ip": "10.0.0.205"}
            {"index":{}}
            {"ip": "10.0.0.206"}
            {"index":{}}
            {"ip": "10.0.0.207"}
            {"index":{}}
            {"ip": "10.0.0.208"}
            {"index":{}}
            {"ip": "10.0.0.209"}
            {"index":{}}
            {"ip": "10.0.0.210"}
            {"index":{}}
            {"ip": "10.0.0.211"}
            {"index":{}}
            {"ip": "10.0.0.212"}
            {"index":{}}
            {"ip": "10.0.0.213"}
            {"index":{}}
            {"ip": "10.0.0.214"}
            {"index":{}}
            {"ip": "10.0.0.215"}
            {"index":{}}
            {"ip": "10.0.0.216"}
            {"index":{}}
            {"ip": "10.0.0.217"}
            {"index":{}}
            {"ip": "10.0.0.218"}
            {"index":{}}
            {"ip": "10.0.0.219"}
            {"index":{}}
            {"ip": "10.0.0.220"}
            {"index":{}}
            {"ip": "10.0.0.221"}
            {"index":{}}
            {"ip": "10.0.0.222"}
            {"index":{}}
            {"ip": "10.0.0.223"}
            {"index":{}}
            {"ip": "10.0.0.224"}
            {"index":{}}
            {"ip": "10.0.0.225"}
            {"index":{}}
            {"ip": "10.0.0.226"}
            {"index":{}}
            {"ip": "10.0.0.227"}
            {"index":{}}
            {"ip": "10.0.0.228"}
            {"index":{}}
            {"ip": "10.0.0.229"}
            {"index":{}}
            {"ip": "10.0.0.230"}
            {"index":{}}
            {"ip": "10.0.0.231"}
            {"index":{}}
            {"ip": "10.0.0.232"}
            {"index":{}}
            {"ip": "10.0.0.233"}
            {"index":{}}
            {"ip": "10.0.0.234"}
            {"index":{}}
            {"ip": "10.0.0.235"}
            {"index":{}}
            {"ip": "10.0.0.236"}
            {"index":{}}
            {"ip": "10.0.0.237"}
            {"index":{}}
            {"ip": "10.0.0.238"}
            {"index":{}}
            {"ip": "10.0.0.239"}
            {"index":{}}
            {"ip": "10.0.0.240"}
            {"index":{}}
            {"ip": "10.0.0.241"}
            {"index":{}}
            {"ip": "10.0.0.242"}
            {"index":{}}
            {"ip": "10.0.0.243"}
            {"index":{}}
            {"ip": "10.0.0.244"}
            {"index":{}}
            {"ip": "10.0.0.245"}
            {"index":{}}
            {"ip": "10.0.0.246"}
            {"index":{}}
            {"ip": "10.0.0.247"}
            {"index":{}}
            {"ip": "10.0.0.248"}
            {"index":{}}
            {"ip": "10.0.0.249"}
            {"index":{}}
            {"ip": "10.0.0.250"}
            {"index":{}}
            {"ip": "10.0.0.251"}
            {"index":{}}
            {"ip": "10.0.0.252"}
            {"index":{}}
            {"ip": "10.0.0.253"}
            {"index":{}}
            {"ip": "10.0.0.254"}
            {"index":{}}
            {"ip": "9.0.0.0"}
            {"index":{}}
            {"ip": "11.0.0.0"}
            {"index":{}}
            {"ip": "12.0.0.0"}
            {"index":{}}
            {"ip": "9.0.0.1"}
            {"index":{}}
            {"ip": "11.0.0.1"}
            {"index":{}}
            {"ip": "12.0.0.1"}
            {"index":{}}
            {"ip": "9.0.0.2"}
            {"index":{}}
            {"ip": "11.0.0.2"}
            {"index":{}}
            {"ip": "12.0.0.2"}
            {"index":{}}
            {"ip": "9.0.0.3"}
            {"index":{}}
            {"ip": "11.0.0.3"}
            {"index":{}}
            {"ip": "12.0.0.3"}
            {"index":{}}
            {"ip": "9.0.0.4"}
            {"index":{}}
            {"ip": "11.0.0.4"}
            {"index":{}}
            {"ip": "12.0.0.4"}
  - do:
      raw:
        method: GET
        path: "ip_addresses/_search"
        body: |
          {
            "size": 0,
            "aggs": {
              "ip_ranges": {
                "ip_range": {
                  "field": "ip",
                  "ranges": [
                    { "mask": "10.0.0.0/25" },
                    { "mask": "10.0.0.127/25" }
                  ]
                }
              }
            }
          }
  - is_false: _shards.failures
  - match:
      $body:
        {
          "took": $body.took,"timed_out": false,"_shards": $body._shards,"hits": $body.hits,
        
          "aggregations": {
            "ip_ranges": {
              "buckets": [
                {
                  "key": "10.0.0.0/25",
                  "from": "10.0.0.0",
                  "to": "10.0.0.128",
                  "doc_count": 128
                },
                {
                  "key": "10.0.0.127/25",
                  "from": "10.0.0.0",
                  "to": "10.0.0.128",
                  "doc_count": 128
                }
              ]
            }
          }
        }
---
"ip-range-keyed-example":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
# Named setup iprange

  - do:
        indices.create:
          index: ip_addresses
          body:
            settings:
              number_of_shards: 1
              number_of_replicas: 1
            mappings:
              properties:
                ip:
                  type: ip
  - do:
        bulk:
          index: ip_addresses
          refresh: true
          body: |
            {"index":{}}
            {"ip": "10.0.0.0"}
            {"index":{}}
            {"ip": "10.0.0.1"}
            {"index":{}}
            {"ip": "10.0.0.2"}
            {"index":{}}
            {"ip": "10.0.0.3"}
            {"index":{}}
            {"ip": "10.0.0.4"}
            {"index":{}}
            {"ip": "10.0.0.5"}
            {"index":{}}
            {"ip": "10.0.0.6"}
            {"index":{}}
            {"ip": "10.0.0.7"}
            {"index":{}}
            {"ip": "10.0.0.8"}
            {"index":{}}
            {"ip": "10.0.0.9"}
            {"index":{}}
            {"ip": "10.0.0.10"}
            {"index":{}}
            {"ip": "10.0.0.11"}
            {"index":{}}
            {"ip": "10.0.0.12"}
            {"index":{}}
            {"ip": "10.0.0.13"}
            {"index":{}}
            {"ip": "10.0.0.14"}
            {"index":{}}
            {"ip": "10.0.0.15"}
            {"index":{}}
            {"ip": "10.0.0.16"}
            {"index":{}}
            {"ip": "10.0.0.17"}
            {"index":{}}
            {"ip": "10.0.0.18"}
            {"index":{}}
            {"ip": "10.0.0.19"}
            {"index":{}}
            {"ip": "10.0.0.20"}
            {"index":{}}
            {"ip": "10.0.0.21"}
            {"index":{}}
            {"ip": "10.0.0.22"}
            {"index":{}}
            {"ip": "10.0.0.23"}
            {"index":{}}
            {"ip": "10.0.0.24"}
            {"index":{}}
            {"ip": "10.0.0.25"}
            {"index":{}}
            {"ip": "10.0.0.26"}
            {"index":{}}
            {"ip": "10.0.0.27"}
            {"index":{}}
            {"ip": "10.0.0.28"}
            {"index":{}}
            {"ip": "10.0.0.29"}
            {"index":{}}
            {"ip": "10.0.0.30"}
            {"index":{}}
            {"ip": "10.0.0.31"}
            {"index":{}}
            {"ip": "10.0.0.32"}
            {"index":{}}
            {"ip": "10.0.0.33"}
            {"index":{}}
            {"ip": "10.0.0.34"}
            {"index":{}}
            {"ip": "10.0.0.35"}
            {"index":{}}
            {"ip": "10.0.0.36"}
            {"index":{}}
            {"ip": "10.0.0.37"}
            {"index":{}}
            {"ip": "10.0.0.38"}
            {"index":{}}
            {"ip": "10.0.0.39"}
            {"index":{}}
            {"ip": "10.0.0.40"}
            {"index":{}}
            {"ip": "10.0.0.41"}
            {"index":{}}
            {"ip": "10.0.0.42"}
            {"index":{}}
            {"ip": "10.0.0.43"}
            {"index":{}}
            {"ip": "10.0.0.44"}
            {"index":{}}
            {"ip": "10.0.0.45"}
            {"index":{}}
            {"ip": "10.0.0.46"}
            {"index":{}}
            {"ip": "10.0.0.47"}
            {"index":{}}
            {"ip": "10.0.0.48"}
            {"index":{}}
            {"ip": "10.0.0.49"}
            {"index":{}}
            {"ip": "10.0.0.50"}
            {"index":{}}
            {"ip": "10.0.0.51"}
            {"index":{}}
            {"ip": "10.0.0.52"}
            {"index":{}}
            {"ip": "10.0.0.53"}
            {"index":{}}
            {"ip": "10.0.0.54"}
            {"index":{}}
            {"ip": "10.0.0.55"}
            {"index":{}}
            {"ip": "10.0.0.56"}
            {"index":{}}
            {"ip": "10.0.0.57"}
            {"index":{}}
            {"ip": "10.0.0.58"}
            {"index":{}}
            {"ip": "10.0.0.59"}
            {"index":{}}
            {"ip": "10.0.0.60"}
            {"index":{}}
            {"ip": "10.0.0.61"}
            {"index":{}}
            {"ip": "10.0.0.62"}
            {"index":{}}
            {"ip": "10.0.0.63"}
            {"index":{}}
            {"ip": "10.0.0.64"}
            {"index":{}}
            {"ip": "10.0.0.65"}
            {"index":{}}
            {"ip": "10.0.0.66"}
            {"index":{}}
            {"ip": "10.0.0.67"}
            {"index":{}}
            {"ip": "10.0.0.68"}
            {"index":{}}
            {"ip": "10.0.0.69"}
            {"index":{}}
            {"ip": "10.0.0.70"}
            {"index":{}}
            {"ip": "10.0.0.71"}
            {"index":{}}
            {"ip": "10.0.0.72"}
            {"index":{}}
            {"ip": "10.0.0.73"}
            {"index":{}}
            {"ip": "10.0.0.74"}
            {"index":{}}
            {"ip": "10.0.0.75"}
            {"index":{}}
            {"ip": "10.0.0.76"}
            {"index":{}}
            {"ip": "10.0.0.77"}
            {"index":{}}
            {"ip": "10.0.0.78"}
            {"index":{}}
            {"ip": "10.0.0.79"}
            {"index":{}}
            {"ip": "10.0.0.80"}
            {"index":{}}
            {"ip": "10.0.0.81"}
            {"index":{}}
            {"ip": "10.0.0.82"}
            {"index":{}}
            {"ip": "10.0.0.83"}
            {"index":{}}
            {"ip": "10.0.0.84"}
            {"index":{}}
            {"ip": "10.0.0.85"}
            {"index":{}}
            {"ip": "10.0.0.86"}
            {"index":{}}
            {"ip": "10.0.0.87"}
            {"index":{}}
            {"ip": "10.0.0.88"}
            {"index":{}}
            {"ip": "10.0.0.89"}
            {"index":{}}
            {"ip": "10.0.0.90"}
            {"index":{}}
            {"ip": "10.0.0.91"}
            {"index":{}}
            {"ip": "10.0.0.92"}
            {"index":{}}
            {"ip": "10.0.0.93"}
            {"index":{}}
            {"ip": "10.0.0.94"}
            {"index":{}}
            {"ip": "10.0.0.95"}
            {"index":{}}
            {"ip": "10.0.0.96"}
            {"index":{}}
            {"ip": "10.0.0.97"}
            {"index":{}}
            {"ip": "10.0.0.98"}
            {"index":{}}
            {"ip": "10.0.0.99"}
            {"index":{}}
            {"ip": "10.0.0.100"}
            {"index":{}}
            {"ip": "10.0.0.101"}
            {"index":{}}
            {"ip": "10.0.0.102"}
            {"index":{}}
            {"ip": "10.0.0.103"}
            {"index":{}}
            {"ip": "10.0.0.104"}
            {"index":{}}
            {"ip": "10.0.0.105"}
            {"index":{}}
            {"ip": "10.0.0.106"}
            {"index":{}}
            {"ip": "10.0.0.107"}
            {"index":{}}
            {"ip": "10.0.0.108"}
            {"index":{}}
            {"ip": "10.0.0.109"}
            {"index":{}}
            {"ip": "10.0.0.110"}
            {"index":{}}
            {"ip": "10.0.0.111"}
            {"index":{}}
            {"ip": "10.0.0.112"}
            {"index":{}}
            {"ip": "10.0.0.113"}
            {"index":{}}
            {"ip": "10.0.0.114"}
            {"index":{}}
            {"ip": "10.0.0.115"}
            {"index":{}}
            {"ip": "10.0.0.116"}
            {"index":{}}
            {"ip": "10.0.0.117"}
            {"index":{}}
            {"ip": "10.0.0.118"}
            {"index":{}}
            {"ip": "10.0.0.119"}
            {"index":{}}
            {"ip": "10.0.0.120"}
            {"index":{}}
            {"ip": "10.0.0.121"}
            {"index":{}}
            {"ip": "10.0.0.122"}
            {"index":{}}
            {"ip": "10.0.0.123"}
            {"index":{}}
            {"ip": "10.0.0.124"}
            {"index":{}}
            {"ip": "10.0.0.125"}
            {"index":{}}
            {"ip": "10.0.0.126"}
            {"index":{}}
            {"ip": "10.0.0.127"}
            {"index":{}}
            {"ip": "10.0.0.128"}
            {"index":{}}
            {"ip": "10.0.0.129"}
            {"index":{}}
            {"ip": "10.0.0.130"}
            {"index":{}}
            {"ip": "10.0.0.131"}
            {"index":{}}
            {"ip": "10.0.0.132"}
            {"index":{}}
            {"ip": "10.0.0.133"}
            {"index":{}}
            {"ip": "10.0.0.134"}
            {"index":{}}
            {"ip": "10.0.0.135"}
            {"index":{}}
            {"ip": "10.0.0.136"}
            {"index":{}}
            {"ip": "10.0.0.137"}
            {"index":{}}
            {"ip": "10.0.0.138"}
            {"index":{}}
            {"ip": "10.0.0.139"}
            {"index":{}}
            {"ip": "10.0.0.140"}
            {"index":{}}
            {"ip": "10.0.0.141"}
            {"index":{}}
            {"ip": "10.0.0.142"}
            {"index":{}}
            {"ip": "10.0.0.143"}
            {"index":{}}
            {"ip": "10.0.0.144"}
            {"index":{}}
            {"ip": "10.0.0.145"}
            {"index":{}}
            {"ip": "10.0.0.146"}
            {"index":{}}
            {"ip": "10.0.0.147"}
            {"index":{}}
            {"ip": "10.0.0.148"}
            {"index":{}}
            {"ip": "10.0.0.149"}
            {"index":{}}
            {"ip": "10.0.0.150"}
            {"index":{}}
            {"ip": "10.0.0.151"}
            {"index":{}}
            {"ip": "10.0.0.152"}
            {"index":{}}
            {"ip": "10.0.0.153"}
            {"index":{}}
            {"ip": "10.0.0.154"}
            {"index":{}}
            {"ip": "10.0.0.155"}
            {"index":{}}
            {"ip": "10.0.0.156"}
            {"index":{}}
            {"ip": "10.0.0.157"}
            {"index":{}}
            {"ip": "10.0.0.158"}
            {"index":{}}
            {"ip": "10.0.0.159"}
            {"index":{}}
            {"ip": "10.0.0.160"}
            {"index":{}}
            {"ip": "10.0.0.161"}
            {"index":{}}
            {"ip": "10.0.0.162"}
            {"index":{}}
            {"ip": "10.0.0.163"}
            {"index":{}}
            {"ip": "10.0.0.164"}
            {"index":{}}
            {"ip": "10.0.0.165"}
            {"index":{}}
            {"ip": "10.0.0.166"}
            {"index":{}}
            {"ip": "10.0.0.167"}
            {"index":{}}
            {"ip": "10.0.0.168"}
            {"index":{}}
            {"ip": "10.0.0.169"}
            {"index":{}}
            {"ip": "10.0.0.170"}
            {"index":{}}
            {"ip": "10.0.0.171"}
            {"index":{}}
            {"ip": "10.0.0.172"}
            {"index":{}}
            {"ip": "10.0.0.173"}
            {"index":{}}
            {"ip": "10.0.0.174"}
            {"index":{}}
            {"ip": "10.0.0.175"}
            {"index":{}}
            {"ip": "10.0.0.176"}
            {"index":{}}
            {"ip": "10.0.0.177"}
            {"index":{}}
            {"ip": "10.0.0.178"}
            {"index":{}}
            {"ip": "10.0.0.179"}
            {"index":{}}
            {"ip": "10.0.0.180"}
            {"index":{}}
            {"ip": "10.0.0.181"}
            {"index":{}}
            {"ip": "10.0.0.182"}
            {"index":{}}
            {"ip": "10.0.0.183"}
            {"index":{}}
            {"ip": "10.0.0.184"}
            {"index":{}}
            {"ip": "10.0.0.185"}
            {"index":{}}
            {"ip": "10.0.0.186"}
            {"index":{}}
            {"ip": "10.0.0.187"}
            {"index":{}}
            {"ip": "10.0.0.188"}
            {"index":{}}
            {"ip": "10.0.0.189"}
            {"index":{}}
            {"ip": "10.0.0.190"}
            {"index":{}}
            {"ip": "10.0.0.191"}
            {"index":{}}
            {"ip": "10.0.0.192"}
            {"index":{}}
            {"ip": "10.0.0.193"}
            {"index":{}}
            {"ip": "10.0.0.194"}
            {"index":{}}
            {"ip": "10.0.0.195"}
            {"index":{}}
            {"ip": "10.0.0.196"}
            {"index":{}}
            {"ip": "10.0.0.197"}
            {"index":{}}
            {"ip": "10.0.0.198"}
            {"index":{}}
            {"ip": "10.0.0.199"}
            {"index":{}}
            {"ip": "10.0.0.200"}
            {"index":{}}
            {"ip": "10.0.0.201"}
            {"index":{}}
            {"ip": "10.0.0.202"}
            {"index":{}}
            {"ip": "10.0.0.203"}
            {"index":{}}
            {"ip": "10.0.0.204"}
            {"index":{}}
            {"ip": "10.0.0.205"}
            {"index":{}}
            {"ip": "10.0.0.206"}
            {"index":{}}
            {"ip": "10.0.0.207"}
            {"index":{}}
            {"ip": "10.0.0.208"}
            {"index":{}}
            {"ip": "10.0.0.209"}
            {"index":{}}
            {"ip": "10.0.0.210"}
            {"index":{}}
            {"ip": "10.0.0.211"}
            {"index":{}}
            {"ip": "10.0.0.212"}
            {"index":{}}
            {"ip": "10.0.0.213"}
            {"index":{}}
            {"ip": "10.0.0.214"}
            {"index":{}}
            {"ip": "10.0.0.215"}
            {"index":{}}
            {"ip": "10.0.0.216"}
            {"index":{}}
            {"ip": "10.0.0.217"}
            {"index":{}}
            {"ip": "10.0.0.218"}
            {"index":{}}
            {"ip": "10.0.0.219"}
            {"index":{}}
            {"ip": "10.0.0.220"}
            {"index":{}}
            {"ip": "10.0.0.221"}
            {"index":{}}
            {"ip": "10.0.0.222"}
            {"index":{}}
            {"ip": "10.0.0.223"}
            {"index":{}}
            {"ip": "10.0.0.224"}
            {"index":{}}
            {"ip": "10.0.0.225"}
            {"index":{}}
            {"ip": "10.0.0.226"}
            {"index":{}}
            {"ip": "10.0.0.227"}
            {"index":{}}
            {"ip": "10.0.0.228"}
            {"index":{}}
            {"ip": "10.0.0.229"}
            {"index":{}}
            {"ip": "10.0.0.230"}
            {"index":{}}
            {"ip": "10.0.0.231"}
            {"index":{}}
            {"ip": "10.0.0.232"}
            {"index":{}}
            {"ip": "10.0.0.233"}
            {"index":{}}
            {"ip": "10.0.0.234"}
            {"index":{}}
            {"ip": "10.0.0.235"}
            {"index":{}}
            {"ip": "10.0.0.236"}
            {"index":{}}
            {"ip": "10.0.0.237"}
            {"index":{}}
            {"ip": "10.0.0.238"}
            {"index":{}}
            {"ip": "10.0.0.239"}
            {"index":{}}
            {"ip": "10.0.0.240"}
            {"index":{}}
            {"ip": "10.0.0.241"}
            {"index":{}}
            {"ip": "10.0.0.242"}
            {"index":{}}
            {"ip": "10.0.0.243"}
            {"index":{}}
            {"ip": "10.0.0.244"}
            {"index":{}}
            {"ip": "10.0.0.245"}
            {"index":{}}
            {"ip": "10.0.0.246"}
            {"index":{}}
            {"ip": "10.0.0.247"}
            {"index":{}}
            {"ip": "10.0.0.248"}
            {"index":{}}
            {"ip": "10.0.0.249"}
            {"index":{}}
            {"ip": "10.0.0.250"}
            {"index":{}}
            {"ip": "10.0.0.251"}
            {"index":{}}
            {"ip": "10.0.0.252"}
            {"index":{}}
            {"ip": "10.0.0.253"}
            {"index":{}}
            {"ip": "10.0.0.254"}
            {"index":{}}
            {"ip": "9.0.0.0"}
            {"index":{}}
            {"ip": "11.0.0.0"}
            {"index":{}}
            {"ip": "12.0.0.0"}
            {"index":{}}
            {"ip": "9.0.0.1"}
            {"index":{}}
            {"ip": "11.0.0.1"}
            {"index":{}}
            {"ip": "12.0.0.1"}
            {"index":{}}
            {"ip": "9.0.0.2"}
            {"index":{}}
            {"ip": "11.0.0.2"}
            {"index":{}}
            {"ip": "12.0.0.2"}
            {"index":{}}
            {"ip": "9.0.0.3"}
            {"index":{}}
            {"ip": "11.0.0.3"}
            {"index":{}}
            {"ip": "12.0.0.3"}
            {"index":{}}
            {"ip": "9.0.0.4"}
            {"index":{}}
            {"ip": "11.0.0.4"}
            {"index":{}}
            {"ip": "12.0.0.4"}
  - do:
      raw:
        method: GET
        path: "ip_addresses/_search"
        body: |
          {
            "size": 0,
            "aggs": {
              "ip_ranges": {
                "ip_range": {
                  "field": "ip",
                  "ranges": [
                    { "to": "10.0.0.5" },
                    { "from": "10.0.0.5" }
                  ],
                  "keyed": true
                }
              }
            }
          }
  - is_false: _shards.failures
  - match:
      $body:
        {
          "took": $body.took,"timed_out": false,"_shards": $body._shards,"hits": $body.hits,
        
          "aggregations": {
            "ip_ranges": {
              "buckets": {
                "*-10.0.0.5": {
                  "to": "10.0.0.5",
                  "doc_count": 10
                },
                "10.0.0.5-*": {
                  "from": "10.0.0.5",
                  "doc_count": 260
                }
              }
            }
          }
        }
---
"ip-range-keyed-customized-keys-example":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
# Named setup iprange

  - do:
        indices.create:
          index: ip_addresses
          body:
            settings:
              number_of_shards: 1
              number_of_replicas: 1
            mappings:
              properties:
                ip:
                  type: ip
  - do:
        bulk:
          index: ip_addresses
          refresh: true
          body: |
            {"index":{}}
            {"ip": "10.0.0.0"}
            {"index":{}}
            {"ip": "10.0.0.1"}
            {"index":{}}
            {"ip": "10.0.0.2"}
            {"index":{}}
            {"ip": "10.0.0.3"}
            {"index":{}}
            {"ip": "10.0.0.4"}
            {"index":{}}
            {"ip": "10.0.0.5"}
            {"index":{}}
            {"ip": "10.0.0.6"}
            {"index":{}}
            {"ip": "10.0.0.7"}
            {"index":{}}
            {"ip": "10.0.0.8"}
            {"index":{}}
            {"ip": "10.0.0.9"}
            {"index":{}}
            {"ip": "10.0.0.10"}
            {"index":{}}
            {"ip": "10.0.0.11"}
            {"index":{}}
            {"ip": "10.0.0.12"}
            {"index":{}}
            {"ip": "10.0.0.13"}
            {"index":{}}
            {"ip": "10.0.0.14"}
            {"index":{}}
            {"ip": "10.0.0.15"}
            {"index":{}}
            {"ip": "10.0.0.16"}
            {"index":{}}
            {"ip": "10.0.0.17"}
            {"index":{}}
            {"ip": "10.0.0.18"}
            {"index":{}}
            {"ip": "10.0.0.19"}
            {"index":{}}
            {"ip": "10.0.0.20"}
            {"index":{}}
            {"ip": "10.0.0.21"}
            {"index":{}}
            {"ip": "10.0.0.22"}
            {"index":{}}
            {"ip": "10.0.0.23"}
            {"index":{}}
            {"ip": "10.0.0.24"}
            {"index":{}}
            {"ip": "10.0.0.25"}
            {"index":{}}
            {"ip": "10.0.0.26"}
            {"index":{}}
            {"ip": "10.0.0.27"}
            {"index":{}}
            {"ip": "10.0.0.28"}
            {"index":{}}
            {"ip": "10.0.0.29"}
            {"index":{}}
            {"ip": "10.0.0.30"}
            {"index":{}}
            {"ip": "10.0.0.31"}
            {"index":{}}
            {"ip": "10.0.0.32"}
            {"index":{}}
            {"ip": "10.0.0.33"}
            {"index":{}}
            {"ip": "10.0.0.34"}
            {"index":{}}
            {"ip": "10.0.0.35"}
            {"index":{}}
            {"ip": "10.0.0.36"}
            {"index":{}}
            {"ip": "10.0.0.37"}
            {"index":{}}
            {"ip": "10.0.0.38"}
            {"index":{}}
            {"ip": "10.0.0.39"}
            {"index":{}}
            {"ip": "10.0.0.40"}
            {"index":{}}
            {"ip": "10.0.0.41"}
            {"index":{}}
            {"ip": "10.0.0.42"}
            {"index":{}}
            {"ip": "10.0.0.43"}
            {"index":{}}
            {"ip": "10.0.0.44"}
            {"index":{}}
            {"ip": "10.0.0.45"}
            {"index":{}}
            {"ip": "10.0.0.46"}
            {"index":{}}
            {"ip": "10.0.0.47"}
            {"index":{}}
            {"ip": "10.0.0.48"}
            {"index":{}}
            {"ip": "10.0.0.49"}
            {"index":{}}
            {"ip": "10.0.0.50"}
            {"index":{}}
            {"ip": "10.0.0.51"}
            {"index":{}}
            {"ip": "10.0.0.52"}
            {"index":{}}
            {"ip": "10.0.0.53"}
            {"index":{}}
            {"ip": "10.0.0.54"}
            {"index":{}}
            {"ip": "10.0.0.55"}
            {"index":{}}
            {"ip": "10.0.0.56"}
            {"index":{}}
            {"ip": "10.0.0.57"}
            {"index":{}}
            {"ip": "10.0.0.58"}
            {"index":{}}
            {"ip": "10.0.0.59"}
            {"index":{}}
            {"ip": "10.0.0.60"}
            {"index":{}}
            {"ip": "10.0.0.61"}
            {"index":{}}
            {"ip": "10.0.0.62"}
            {"index":{}}
            {"ip": "10.0.0.63"}
            {"index":{}}
            {"ip": "10.0.0.64"}
            {"index":{}}
            {"ip": "10.0.0.65"}
            {"index":{}}
            {"ip": "10.0.0.66"}
            {"index":{}}
            {"ip": "10.0.0.67"}
            {"index":{}}
            {"ip": "10.0.0.68"}
            {"index":{}}
            {"ip": "10.0.0.69"}
            {"index":{}}
            {"ip": "10.0.0.70"}
            {"index":{}}
            {"ip": "10.0.0.71"}
            {"index":{}}
            {"ip": "10.0.0.72"}
            {"index":{}}
            {"ip": "10.0.0.73"}
            {"index":{}}
            {"ip": "10.0.0.74"}
            {"index":{}}
            {"ip": "10.0.0.75"}
            {"index":{}}
            {"ip": "10.0.0.76"}
            {"index":{}}
            {"ip": "10.0.0.77"}
            {"index":{}}
            {"ip": "10.0.0.78"}
            {"index":{}}
            {"ip": "10.0.0.79"}
            {"index":{}}
            {"ip": "10.0.0.80"}
            {"index":{}}
            {"ip": "10.0.0.81"}
            {"index":{}}
            {"ip": "10.0.0.82"}
            {"index":{}}
            {"ip": "10.0.0.83"}
            {"index":{}}
            {"ip": "10.0.0.84"}
            {"index":{}}
            {"ip": "10.0.0.85"}
            {"index":{}}
            {"ip": "10.0.0.86"}
            {"index":{}}
            {"ip": "10.0.0.87"}
            {"index":{}}
            {"ip": "10.0.0.88"}
            {"index":{}}
            {"ip": "10.0.0.89"}
            {"index":{}}
            {"ip": "10.0.0.90"}
            {"index":{}}
            {"ip": "10.0.0.91"}
            {"index":{}}
            {"ip": "10.0.0.92"}
            {"index":{}}
            {"ip": "10.0.0.93"}
            {"index":{}}
            {"ip": "10.0.0.94"}
            {"index":{}}
            {"ip": "10.0.0.95"}
            {"index":{}}
            {"ip": "10.0.0.96"}
            {"index":{}}
            {"ip": "10.0.0.97"}
            {"index":{}}
            {"ip": "10.0.0.98"}
            {"index":{}}
            {"ip": "10.0.0.99"}
            {"index":{}}
            {"ip": "10.0.0.100"}
            {"index":{}}
            {"ip": "10.0.0.101"}
            {"index":{}}
            {"ip": "10.0.0.102"}
            {"index":{}}
            {"ip": "10.0.0.103"}
            {"index":{}}
            {"ip": "10.0.0.104"}
            {"index":{}}
            {"ip": "10.0.0.105"}
            {"index":{}}
            {"ip": "10.0.0.106"}
            {"index":{}}
            {"ip": "10.0.0.107"}
            {"index":{}}
            {"ip": "10.0.0.108"}
            {"index":{}}
            {"ip": "10.0.0.109"}
            {"index":{}}
            {"ip": "10.0.0.110"}
            {"index":{}}
            {"ip": "10.0.0.111"}
            {"index":{}}
            {"ip": "10.0.0.112"}
            {"index":{}}
            {"ip": "10.0.0.113"}
            {"index":{}}
            {"ip": "10.0.0.114"}
            {"index":{}}
            {"ip": "10.0.0.115"}
            {"index":{}}
            {"ip": "10.0.0.116"}
            {"index":{}}
            {"ip": "10.0.0.117"}
            {"index":{}}
            {"ip": "10.0.0.118"}
            {"index":{}}
            {"ip": "10.0.0.119"}
            {"index":{}}
            {"ip": "10.0.0.120"}
            {"index":{}}
            {"ip": "10.0.0.121"}
            {"index":{}}
            {"ip": "10.0.0.122"}
            {"index":{}}
            {"ip": "10.0.0.123"}
            {"index":{}}
            {"ip": "10.0.0.124"}
            {"index":{}}
            {"ip": "10.0.0.125"}
            {"index":{}}
            {"ip": "10.0.0.126"}
            {"index":{}}
            {"ip": "10.0.0.127"}
            {"index":{}}
            {"ip": "10.0.0.128"}
            {"index":{}}
            {"ip": "10.0.0.129"}
            {"index":{}}
            {"ip": "10.0.0.130"}
            {"index":{}}
            {"ip": "10.0.0.131"}
            {"index":{}}
            {"ip": "10.0.0.132"}
            {"index":{}}
            {"ip": "10.0.0.133"}
            {"index":{}}
            {"ip": "10.0.0.134"}
            {"index":{}}
            {"ip": "10.0.0.135"}
            {"index":{}}
            {"ip": "10.0.0.136"}
            {"index":{}}
            {"ip": "10.0.0.137"}
            {"index":{}}
            {"ip": "10.0.0.138"}
            {"index":{}}
            {"ip": "10.0.0.139"}
            {"index":{}}
            {"ip": "10.0.0.140"}
            {"index":{}}
            {"ip": "10.0.0.141"}
            {"index":{}}
            {"ip": "10.0.0.142"}
            {"index":{}}
            {"ip": "10.0.0.143"}
            {"index":{}}
            {"ip": "10.0.0.144"}
            {"index":{}}
            {"ip": "10.0.0.145"}
            {"index":{}}
            {"ip": "10.0.0.146"}
            {"index":{}}
            {"ip": "10.0.0.147"}
            {"index":{}}
            {"ip": "10.0.0.148"}
            {"index":{}}
            {"ip": "10.0.0.149"}
            {"index":{}}
            {"ip": "10.0.0.150"}
            {"index":{}}
            {"ip": "10.0.0.151"}
            {"index":{}}
            {"ip": "10.0.0.152"}
            {"index":{}}
            {"ip": "10.0.0.153"}
            {"index":{}}
            {"ip": "10.0.0.154"}
            {"index":{}}
            {"ip": "10.0.0.155"}
            {"index":{}}
            {"ip": "10.0.0.156"}
            {"index":{}}
            {"ip": "10.0.0.157"}
            {"index":{}}
            {"ip": "10.0.0.158"}
            {"index":{}}
            {"ip": "10.0.0.159"}
            {"index":{}}
            {"ip": "10.0.0.160"}
            {"index":{}}
            {"ip": "10.0.0.161"}
            {"index":{}}
            {"ip": "10.0.0.162"}
            {"index":{}}
            {"ip": "10.0.0.163"}
            {"index":{}}
            {"ip": "10.0.0.164"}
            {"index":{}}
            {"ip": "10.0.0.165"}
            {"index":{}}
            {"ip": "10.0.0.166"}
            {"index":{}}
            {"ip": "10.0.0.167"}
            {"index":{}}
            {"ip": "10.0.0.168"}
            {"index":{}}
            {"ip": "10.0.0.169"}
            {"index":{}}
            {"ip": "10.0.0.170"}
            {"index":{}}
            {"ip": "10.0.0.171"}
            {"index":{}}
            {"ip": "10.0.0.172"}
            {"index":{}}
            {"ip": "10.0.0.173"}
            {"index":{}}
            {"ip": "10.0.0.174"}
            {"index":{}}
            {"ip": "10.0.0.175"}
            {"index":{}}
            {"ip": "10.0.0.176"}
            {"index":{}}
            {"ip": "10.0.0.177"}
            {"index":{}}
            {"ip": "10.0.0.178"}
            {"index":{}}
            {"ip": "10.0.0.179"}
            {"index":{}}
            {"ip": "10.0.0.180"}
            {"index":{}}
            {"ip": "10.0.0.181"}
            {"index":{}}
            {"ip": "10.0.0.182"}
            {"index":{}}
            {"ip": "10.0.0.183"}
            {"index":{}}
            {"ip": "10.0.0.184"}
            {"index":{}}
            {"ip": "10.0.0.185"}
            {"index":{}}
            {"ip": "10.0.0.186"}
            {"index":{}}
            {"ip": "10.0.0.187"}
            {"index":{}}
            {"ip": "10.0.0.188"}
            {"index":{}}
            {"ip": "10.0.0.189"}
            {"index":{}}
            {"ip": "10.0.0.190"}
            {"index":{}}
            {"ip": "10.0.0.191"}
            {"index":{}}
            {"ip": "10.0.0.192"}
            {"index":{}}
            {"ip": "10.0.0.193"}
            {"index":{}}
            {"ip": "10.0.0.194"}
            {"index":{}}
            {"ip": "10.0.0.195"}
            {"index":{}}
            {"ip": "10.0.0.196"}
            {"index":{}}
            {"ip": "10.0.0.197"}
            {"index":{}}
            {"ip": "10.0.0.198"}
            {"index":{}}
            {"ip": "10.0.0.199"}
            {"index":{}}
            {"ip": "10.0.0.200"}
            {"index":{}}
            {"ip": "10.0.0.201"}
            {"index":{}}
            {"ip": "10.0.0.202"}
            {"index":{}}
            {"ip": "10.0.0.203"}
            {"index":{}}
            {"ip": "10.0.0.204"}
            {"index":{}}
            {"ip": "10.0.0.205"}
            {"index":{}}
            {"ip": "10.0.0.206"}
            {"index":{}}
            {"ip": "10.0.0.207"}
            {"index":{}}
            {"ip": "10.0.0.208"}
            {"index":{}}
            {"ip": "10.0.0.209"}
            {"index":{}}
            {"ip": "10.0.0.210"}
            {"index":{}}
            {"ip": "10.0.0.211"}
            {"index":{}}
            {"ip": "10.0.0.212"}
            {"index":{}}
            {"ip": "10.0.0.213"}
            {"index":{}}
            {"ip": "10.0.0.214"}
            {"index":{}}
            {"ip": "10.0.0.215"}
            {"index":{}}
            {"ip": "10.0.0.216"}
            {"index":{}}
            {"ip": "10.0.0.217"}
            {"index":{}}
            {"ip": "10.0.0.218"}
            {"index":{}}
            {"ip": "10.0.0.219"}
            {"index":{}}
            {"ip": "10.0.0.220"}
            {"index":{}}
            {"ip": "10.0.0.221"}
            {"index":{}}
            {"ip": "10.0.0.222"}
            {"index":{}}
            {"ip": "10.0.0.223"}
            {"index":{}}
            {"ip": "10.0.0.224"}
            {"index":{}}
            {"ip": "10.0.0.225"}
            {"index":{}}
            {"ip": "10.0.0.226"}
            {"index":{}}
            {"ip": "10.0.0.227"}
            {"index":{}}
            {"ip": "10.0.0.228"}
            {"index":{}}
            {"ip": "10.0.0.229"}
            {"index":{}}
            {"ip": "10.0.0.230"}
            {"index":{}}
            {"ip": "10.0.0.231"}
            {"index":{}}
            {"ip": "10.0.0.232"}
            {"index":{}}
            {"ip": "10.0.0.233"}
            {"index":{}}
            {"ip": "10.0.0.234"}
            {"index":{}}
            {"ip": "10.0.0.235"}
            {"index":{}}
            {"ip": "10.0.0.236"}
            {"index":{}}
            {"ip": "10.0.0.237"}
            {"index":{}}
            {"ip": "10.0.0.238"}
            {"index":{}}
            {"ip": "10.0.0.239"}
            {"index":{}}
            {"ip": "10.0.0.240"}
            {"index":{}}
            {"ip": "10.0.0.241"}
            {"index":{}}
            {"ip": "10.0.0.242"}
            {"index":{}}
            {"ip": "10.0.0.243"}
            {"index":{}}
            {"ip": "10.0.0.244"}
            {"index":{}}
            {"ip": "10.0.0.245"}
            {"index":{}}
            {"ip": "10.0.0.246"}
            {"index":{}}
            {"ip": "10.0.0.247"}
            {"index":{}}
            {"ip": "10.0.0.248"}
            {"index":{}}
            {"ip": "10.0.0.249"}
            {"index":{}}
            {"ip": "10.0.0.250"}
            {"index":{}}
            {"ip": "10.0.0.251"}
            {"index":{}}
            {"ip": "10.0.0.252"}
            {"index":{}}
            {"ip": "10.0.0.253"}
            {"index":{}}
            {"ip": "10.0.0.254"}
            {"index":{}}
            {"ip": "9.0.0.0"}
            {"index":{}}
            {"ip": "11.0.0.0"}
            {"index":{}}
            {"ip": "12.0.0.0"}
            {"index":{}}
            {"ip": "9.0.0.1"}
            {"index":{}}
            {"ip": "11.0.0.1"}
            {"index":{}}
            {"ip": "12.0.0.1"}
            {"index":{}}
            {"ip": "9.0.0.2"}
            {"index":{}}
            {"ip": "11.0.0.2"}
            {"index":{}}
            {"ip": "12.0.0.2"}
            {"index":{}}
            {"ip": "9.0.0.3"}
            {"index":{}}
            {"ip": "11.0.0.3"}
            {"index":{}}
            {"ip": "12.0.0.3"}
            {"index":{}}
            {"ip": "9.0.0.4"}
            {"index":{}}
            {"ip": "11.0.0.4"}
            {"index":{}}
            {"ip": "12.0.0.4"}
  - do:
      raw:
        method: GET
        path: "ip_addresses/_search"
        body: |
          {
            "size": 0,
            "aggs": {
              "ip_ranges": {
                "ip_range": {
                  "field": "ip",
                  "ranges": [
                    { "key": "infinity", "to": "10.0.0.5" },
                    { "key": "and-beyond", "from": "10.0.0.5" }
                  ],
                  "keyed": true
                }
              }
            }
          }
  - is_false: _shards.failures
  - match:
      $body:
        {
          "took": $body.took,"timed_out": false,"_shards": $body._shards,"hits": $body.hits,
        
          "aggregations": {
            "ip_ranges": {
              "buckets": {
                "infinity": {
                  "to": "10.0.0.5",
                  "doc_count": 10
                },
                "and-beyond": {
                  "from": "10.0.0.5",
                  "doc_count": 260
                }
              }
            }
          }
        }
