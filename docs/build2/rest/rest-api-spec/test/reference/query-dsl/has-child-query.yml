---
setup:
  - do:
      raw:
        method: PUT
        path: "my-index-000001"
        body: |
          {
            "mappings": {
              "properties": {
                "my-join-field": {
                  "type": "join",
                  "relations": {
                    "parent": "child"
                  }
                }
              }
            }
          }
---
"line_53":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: GET
        path: "_search"
        body: |
          {
            "query": {
              "has_child": {
                "type": "child",
                "query": {
                  "match_all": {}
                },
                "max_children": 10,
                "min_children": 2,
                "score_mode": "min"
              }
            }
          }
  - is_false: _shards.failures
---
"line_141":
  - skip:
      features:
        - default_shards
        - stash_in_key
        - stash_in_path
        - stash_path_replace
        - warnings
  - do:
      raw:
        method: GET
        path: "_search"
        body: |
          {
            "query": {
              "has_child": {
                "type": "child",
                "query": {
                  "function_score": {
                    "script_score": {
                      "script": "_score * doc['click_count'].value"
                    }
                  }
                },
                "score_mode": "max"
              }
            }
          }
  - is_false: _shards.failures
