rootProject {
  if (project.name == 'elasticsearch') {
    afterEvaluate {
      testClusters.configureEach {
        numberOfNodes = 2
      }
      def cluster = testClusters.named("runTask").get()
      cluster.getNodes().each { node ->
        node.setting('cluster.initial_master_nodes', cluster.getLastNode().getName())
        node.setting('node.roles', '[master,data_hot,data_content]')
      }
      cluster.getFirstNode().setting('node.roles', '[]')
    }
  }
}
