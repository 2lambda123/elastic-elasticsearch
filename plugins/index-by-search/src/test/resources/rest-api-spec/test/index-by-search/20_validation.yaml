---
"no body fails":
  - do:
      catch: /body required/
      index_by_search: {}

---
"junk in body fails":
  - do:
      catch: /unknown field \[junk\]/
      index_by_search:
        body:
          junk:
            more_junk:

---
"junk in source fails":
  - do:
      catch: /unknown field \[junk\]/
      index_by_search:
        body:
          source:
            junk: {}

---
"junk in dest fails":
  - do:
      catch: /unknown field \[junk\]/
      index_by_search:
        body:
          dest:
            junk: {}

---
"no index on destination fails":
  - do:
      catch: /index must be specified/
      index_by_search:
        body:
          dest: {}

---
"search size is accepted":
  - do:
      index:
        index:   source
        type:    foo
        id:      1
        body:    { "text": "test" }
  - do:
      index_by_search:
        body:
          source:
            index: source
            search:
              size:  1000
          dest:
            index:   dest

---
"destination can used instead of 'dest'":
  - do:
      index:
        index:   source
        type:    foo
        id:      1
        body:    { "text": "test" }
  - do:
      index_by_search:
        body:
          source:
            index: source
          destination:
            index:   dest

---
"search size fails if not a number":
  - do:
      catch: '/NumberFormatException: For input string: "cat"/'
      index_by_search:
        body:
          source:
            search:
              size: cat
          dest:
            index: dest

---
"search from is not supported":
  - do:
      catch: /from is not supported in this context/
      index_by_search:
        body:
          source:
            search:
              from: 1
          dest:
            index: dest

---
"overwriting version is not supported":
  - do:
      catch: /.*\[dest\] unknown field \[version\].*/
      index_by_search:
        body:
          dest:
            version: 10

---
"overwriting version type is not supported":
  - do:
      catch: /.*\[dest\] unknown field \[version_type\].*/
      index_by_search:
        body:
          dest:
            version_type: external

---
"bad conflicts is error":
  - do:
      catch: /.*conflicts may only be "proceed" or "abort" but was \[cat\]/
      index_by_search:
        body:
          conflicts: cat
