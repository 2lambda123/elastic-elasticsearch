---
"Update in place picks up new fields":
  - do:
      indices.create:
        index: test
        body:
          mappings:
            place:
              properties:
                name:
                  type: string

  - do:
      index:
        index:   test
        type:    place
        id:      1
        refresh: true
        body:    { "name": "bob's house" }

  - do:
      indices.put_mapping:
        index: test
        type:  place
        body:
          properties:
            name:
              type: string
              fields:
                english:
                  type:     string
                  analyzer: english

  - do:
      search:
        index: test
        body:
          query:
            match:
              name.english: bob
  - match: { hits.total: 0 }

  - do:
      index_by_search:
        body:
          source:
            index: test
          index:
            index: test
  - do:
      indices.refresh: {}

  - do:
      search:
        index: test
        body:
          query:
            match:
              name.english: bob
  - match: { hits.total: 1 }
