"Basic mapping transform":
  - do:
    indices.create:
      index:  test
      body:
        mappings:
          test:
            transform:
              script: "ctx._source['test_dest'] = ctx._source['test']"
              lang: groovy
            properties:
              test:
                type: string
              test_dest:
                type: string
  - do:
    cluster.health:
      wait_for_status: yellow
  - do:
    index:
      index:   test
      type:    type
      id:      1
      body:    { "test": "test" }
      refresh: true
  - do:
    search:
      index: test
      body:
        query:
          match:
            test: test
  - match: { hits.total: 1 }
