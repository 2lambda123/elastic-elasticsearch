import org.elasticsearch.gradle.precommit.JarHellTask

plugins {
    id 'java'
    id 'elasticsearch.build'
}

dependencyLicenses.enabled = false
dependenciesInfo.enabled = false
forbiddenApisMain.enabled = false
forbiddenApisTest.enabled = false
thirdPartyAudit.enabled = false
ext.licenseFile = file("$buildDir/dummy/license")
ext.noticeFile = file("$buildDir/dummy/notice")

repositories {
    mavenCentral()
    repositories {
        maven {
            url System.getProperty("local.repo.path")
        }
    }
}

sourceSets {
    moduleinfo {

    }
}

dependencies {
    // Needed for the JarHell task
    testCompile ("org.elasticsearch.test:framework:${versions.elasticsearch}")

    moduleinfoCompile ("org.elasticsearch.test:framework:${versions.elasticsearch}") {
        exclude group: "org.apache.logging.log4j", module: "log4j-api"
    }
    //  both contain module-info.class
    moduleinfoCompile 'org.apache.logging.log4j:log4j-api:2.10.0'
    moduleinfoCompile 'org.projectlombok:lombok:1.18.2'
}

task jarHellModuleInfo(type: JarHellTask) {
    classpath = project.sourceSets.moduleinfo.runtimeClasspath
}

namingConventions.enabled = false
