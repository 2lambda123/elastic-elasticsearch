---
"cluster health basic test":
  - skip:
      version: "- 8.6.99"
      reason: "the API path changed in 8.7"

  - do:
      health_report: { }

  - is_true: cluster_name
  - match:   { indicators.master_is_stable.status: "green" }
  - match:   { indicators.master_is_stable.symptom: "The cluster has a stable master node" }

  # Ensure that cluster state updates have been processed and the health node is elected
  - do:
      cluster.health:
        wait_for_status: green
        wait_for_events: languid

  # Check the over all status
  - do:
      health_report: { }

  - is_true: cluster_name
  - match: { status: "green" }
