---
setup:
  - do:
        indices.create:
          index: test-1
          body:
            mappings:
              properties:
                foo:
                  type: long
                bar:
                  type: keyword
                baz:
                  type: text

  - do:
      index:
        index:  test-1
        body:   { foo: "42" }

  - do:
      indices.refresh:
        index: [test-1]

---
"Field caps with with include_empty_fields false":
  - skip:
      version: " - 8.12.99"
      reason: include_empty_fields has been added in 8.13.0

  - do:
      field_caps:
        include_empty_fields: false
        index: test1
        fields: "*"

  - match: {indices:                                      ["test-1"]}
  - is_true: fields.foo
  - is_false: fields.bar
  - is_false: fields.baz
