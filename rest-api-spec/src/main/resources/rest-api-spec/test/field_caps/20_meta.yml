---
"Merge metadata across multiple indices":

  - skip:
      version: " - 7.99.99"
      reason: Metadata support was added in 7.6

  - do:
        indices.create:
          index: test1
          body:
              mappings:
                properties:
                  latency:
                    type: long
                    meta:
                      unit: ms

  - do:
        indices.create:
          index: test2
          body:
              mappings:
                properties:
                  latency:
                    type: long
                    meta:
                      unit: ns
  - do:
        indices.create:
          index: test3
          body:
              mappings:
                properties:

  - do:
      field_caps:
        index: test3
        fields: [latency]

  - is_false: fields.latency.long.meta.unit

  - do:
      field_caps:
        index: test1
        fields: [latency]

  - match: {fields.latency.long.meta.unit:              ["ms"]}

  - do:
      field_caps:
        index: test1,test3
        fields: [latency]

  - match: {fields.latency.long.meta.unit:              ["ms"]}

  - do:
      field_caps:
        index: test1,test2,test3
        fields: [latency]

  - match: {fields.latency.long.meta.unit:              ["ms", "ns"]}
