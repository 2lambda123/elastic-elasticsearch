//
// Tests for IP fields
//

selectAll
SELECT * FROM logs ORDER BY id LIMIT 10;

       @timestamp       |   bytes_in    |   bytes_out   |   client_ip   |  client_port  |    dest_ip    |      id       |    status     
------------------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------
2017-11-10T21:15:54.130Z|47             |388            |10.0.1.166     |9152           |172.27.1.1     |1              |OK             
2017-11-10T21:15:39.988Z|29             |374            |10.0.1.166     |31693          |172.27.1.1     |2              |OK             
2017-11-10T21:15:39.611Z|35             |303            |10.0.1.166     |23625          |172.27.1.1     |3              |OK             
2017-11-10T21:15:39.601Z|36             |312            |10.0.1.166     |9932           |172.27.1.1     |4              |OK             
2017-11-10T21:15:40.792Z|35             |344            |10.0.1.166     |22695          |172.27.1.1     |5              |OK             
2017-11-10T21:15:40.805Z|31             |503            |10.0.1.166     |59811          |172.27.1.1     |6              |OK             
2017-11-10T21:15:40.790Z|35             |458            |10.0.1.166     |57372          |172.27.1.1     |7              |OK             
2017-11-10T21:15:41.799Z|35             |281            |10.0.1.166     |17370          |172.27.1.1     |8              |OK             
2017-11-10T21:15:41.867Z|46             |231            |10.0.1.166     |65004          |172.27.1.1     |9              |OK             
2017-11-10T20:36:07.364Z|40             |506            |10.0.1.166     |22661          |172.27.1.1     |10             |OK  
;

selectIpField
SELECT client_ip, dest_ip FROM logs ORDER BY id LIMIT 10;

   client_ip   |    dest_ip    
---------------+---------------
10.0.1.166     |172.27.1.1     
10.0.1.166     |172.27.1.1     
10.0.1.166     |172.27.1.1     
10.0.1.166     |172.27.1.1     
10.0.1.166     |172.27.1.1     
10.0.1.166     |172.27.1.1     
10.0.1.166     |172.27.1.1     
10.0.1.166     |172.27.1.1     
10.0.1.166     |172.27.1.1     
10.0.1.166     |172.27.1.1 
;

orderByIpField
SELECT client_ip FROM logs ORDER BY client_ip LIMIT 10;

   client_ip   
---------------
10.0.1.122     
10.0.1.122     
10.0.1.122     
10.0.1.122     
10.0.1.122     
10.0.1.122     
10.0.1.122     
10.0.1.122     
10.0.1.122     
10.0.1.122 
;

filterExactMatchIpv4
SELECT id, client_ip, dest_ip FROM logs WHERE client_ip = '10.0.1.166' ORDER BY id LIMIT 10;

      id       |   client_ip   |    dest_ip    
---------------+---------------+---------------
1              |10.0.1.166     |172.27.1.1     
2              |10.0.1.166     |172.27.1.1     
3              |10.0.1.166     |172.27.1.1     
4              |10.0.1.166     |172.27.1.1     
5              |10.0.1.166     |172.27.1.1     
6              |10.0.1.166     |172.27.1.1     
7              |10.0.1.166     |172.27.1.1     
8              |10.0.1.166     |172.27.1.1     
9              |10.0.1.166     |172.27.1.1     
10             |10.0.1.166     |172.27.1.1      
;

filterExactMatchIpv6
SELECT id, client_ip, dest_ip FROM logs WHERE dest_ip = 'fe80::86ba:3bff:fe05:c3f3' ORDER BY id LIMIT 10;

      id       |   client_ip   |         dest_ip         
---------------+---------------+-------------------------
19             |10.0.1.222     |fe80::86ba:3bff:fe05:c3f3
;


filterRangeIpv4
SELECT id, client_ip, dest_ip FROM logs WHERE client_ip BETWEEN '10.0.1.1' AND '10.0.1.200' ORDER BY id LIMIT 10;

      id       |   client_ip   |    dest_ip    
---------------+---------------+---------------
1              |10.0.1.166     |172.27.1.1     
2              |10.0.1.166     |172.27.1.1     
3              |10.0.1.166     |172.27.1.1     
4              |10.0.1.166     |172.27.1.1     
5              |10.0.1.166     |172.27.1.1     
6              |10.0.1.166     |172.27.1.1     
7              |10.0.1.166     |172.27.1.1     
8              |10.0.1.166     |172.27.1.1     
9              |10.0.1.166     |172.27.1.1     
10             |10.0.1.166     |172.27.1.1   
;

filterRangeCIDRIpv4
SELECT id, client_ip, dest_ip FROM logs WHERE client_ip = '10.0.0.0/16' ORDER BY id LIMIT 10;

      id       |   client_ip   |    dest_ip    
---------------+---------------+---------------
1              |10.0.1.166     |172.27.1.1     
2              |10.0.1.166     |172.27.1.1     
3              |10.0.1.166     |172.27.1.1     
4              |10.0.1.166     |172.27.1.1     
5              |10.0.1.166     |172.27.1.1     
6              |10.0.1.166     |172.27.1.1     
7              |10.0.1.166     |172.27.1.1     
8              |10.0.1.166     |172.27.1.1     
9              |10.0.1.166     |172.27.1.1     
10             |10.0.1.166     |172.27.1.1 
;

filterRangeCIDRIpv6
SELECT id, client_ip, dest_ip FROM logs WHERE dest_ip = '2001:cafe::/48' ORDER BY id LIMIT 10;

      id       |   client_ip   |           dest_ip            
---------------+---------------+------------------------------
20             |10.0.1.199     |2001:cafe::ff07:bdcc:bc59:ff9f
22             |10.0.1.166     |2001:cafe::ff07:bdcc:bc59:ff9f
23             |10.0.1.199     |2001:cafe::d46a:9bdc:8126:b00b
24             |10.0.1.166     |2001:cafe::13e1:16fc:8726:1bf8
25             |10.0.1.199     |2001:cafe::ff07:bdcc:bc59:ff9f
26             |10.0.1.166     |2001:cafe::ff07:bdcc:bc59:ff9f
27             |10.0.1.199     |2001:cafe::13e1:16fc:8726:1bf8
28             |10.0.1.199     |2001:cafe::ff07:bdcc:bc59:ff9f
29             |10.0.1.166     |2001:cafe::ff07:bdcc:bc59:ff9f
30             |10.0.1.199     |2001:cafe::13e1:16fc:8726:1bf8
;

//
// below - not supported yet by composite-aggs
// 
groupByIp-Ignore
SELECT client_ip FROM logs GROUP BY client_ip LIMIT 10;

id | client_ip | dest_ip
1    | 10.0.0.1  | 10.0.0.1
;

// not supported yet by composite-aggs
groupByWithMinAndMaxOnIp-Ignore
SELECT status, MIN(dest_ip) FROM logs GROUP BY status ORDER BY status LIMIT 10;

id | client_ip | dest_ip
1    | 10.0.0.1  | 10.0.0.1
;
