---
"Test basic query rule lifecycle":

  - do:
      query_rules.put:
        rulesetId: my-rules-id
        body:
          mappings:
            user: kimchy
          rules: [{ "condition" : { "foo"}, "action" : {}}]

  - match: { acknowledged: true }

  - do:
      query_rules.get:
        rulesetId: my-rules-id

  - match: { ruleset_id: my-rules-id }
  - match: { found: true }
  - match: { _source.mappings.user: kimchy }
  - is_true: _source.rules.0.condition
  - is_true: _source.rules.0.action

  - do:
      query_rules.get:
        rulesetId: some-other-id

  - match: { ruleset_id : some-other-id }
  - match: { found : false }

  - do:
      query_rules.delete:
        rulesetId: my-rules-id

  - do:
      query_rules.get:
        rulesetId: my-rules-id

  - match: { ruleset_id: my-rules-id }
  - match: { found: false }
