# This file is populated with additional EQL queries that were not present in the original EQL python implementation
# test_queries.toml file in order to keep the original unchanges and easier to sync with the EQL reference implementation tests.


[[queries]]
expected_event_ids = [95]
query = '''
file where between(file_path, "dev", ".json", false) == "\\TestLogs\\something"
'''

[[queries]]
expected_event_ids = [95]
query = '''
file where between(file_path, "dev", ".json", true) == "\\TestLogs\\something"
'''

[[queries]]
description = "test string concatenation. update test to avoid case-sensitivity issues"
query = '''
process where concat(serial_event_id, '::', process_name, '::', opcode) == '5::wininit.exe::3'
'''
expected_event_ids  = [5]


[[queries]]
description = "test string concatenation. updated test to avoid case-sensitivity issues"
query = '''
process where concat(serial_event_id, '::', null, '::', 3) == '5::::3'
'''
expected_event_ids  = [5]


[[queries]]
description = "test string concatenation with null behavior"
query = '''
process where concat(serial_event_id, '::', parent_process_path, '::', 3) == '5::::3'
'''
expected_event_ids  = [5]


[[queries]]
query = 'process where concat(serial_event_id) = "1"'
expected_event_ids  = [1]

[[queries]]
query = 'process where serial_event_id < 5 and concat(null) == ""'
expected_event_ids  = [1, 2, 3, 4]


[[queries]]
query = 'process where serial_event_id < 5 and concat(null, null, null) == ""'
expected_event_ids  = [1, 2, 3, 4]


[[queries]]
query = 'process where string(serial_event_id) = "1"'
expected_event_ids  = [1]
