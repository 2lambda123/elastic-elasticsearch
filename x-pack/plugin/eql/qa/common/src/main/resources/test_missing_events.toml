[[queries]]
name = "missingInBetween_noMatches"
query = '''
  sequence with maxspan=1s
    [ test1 where tag == "normal" ]
   -[ test1 where tag == "nonexisting"]
    [ test1 where tag == "normal" ]
'''
expected_event_ids  = [1,2,2,4]


[[queries]]
name = "missingInBetween_noMatches_head"
query = '''
  sequence with maxspan=1s
    [ test1 where tag == "normal" ]
   -[ test1 where tag == "nonexisting"]
    [ test1 where tag == "normal" ]
  | head 1
'''
expected_event_ids  = [1,2]


[[queries]]
name = "missingInBetween_noMatches_tail"
query = '''
  sequence with maxspan=1s
    [ test1 where tag == "normal" ]
   -[ test1 where tag == "nonexisting"]
    [ test1 where tag == "normal" ]
  | tail 1
'''
expected_event_ids  = [2,4]


[[queries]]
name = "missingInBetween_match"
query = '''
  sequence with maxspan=1s
    [ test1 where tag == "normal" ]
   -[ test1 where tag == "missing"]
    [ test1 where tag == "normal" ]
'''
expected_event_ids  = [1,2]


[[queries]]
name = "positivePlusMissing"
query = '''
  sequence with maxspan=1s
    [ test1 where tag == "normal" ]
   -[ test1 where tag == "missing"]
'''
expected_event_ids  = [4]

[[queries]]
name = "skipFirstMatchAndPickSecondCandidate"
query = '''
  sequence with maxspan=1s
    [ test2 where tag == "normal" ]
    [ test2 where tag == "normal" ]
   -[ test2 where tag == "missing"]
    [ test2 where tag == "normal" ]
'''
expected_event_ids  = [2,4,5]


[[queries]]
name = "leadingSimple"
query = '''
  sequence with maxspan=3m
   -[ test3 where tag == "missing" ]
    [ test3 where tag == "normal" ]
'''
expected_event_ids  = [2, 5, 6]


[[queries]]
name = "leadingAndTrailingExcluded1"
query = '''
  sequence with maxspan=19m
   -[ test3 where tag == "missing" ]
    [ test3 where tag == "normal" ]
   -[ test3 where tag == "missing" ]
'''
expected_event_ids  = [2, 4, 5, 6]


[[queries]]
name = "leadingAndTrailingExcluded2"
query = '''
  sequence with maxspan=21m
   -[ test3 where tag == "missing" ]
    [ test3 where tag == "normal" ]
   -[ test3 where tag == "missing" ]
'''
expected_event_ids  = [4, 5, 6]


[[queries]]
name = "multipleMissing1"
query = '''
  sequence with maxspan=1s
    [ test4 where tag == "A" ]
    [ test4 where tag == "B" ]
   -[ test4 where tag == "M1"]
    [ test4 where tag == "C" ]
   -[ test4 where tag == "M2"]
    [ test4 where tag == "D" ]
'''
expected_event_ids  = [13, 14, 16, 17]

[[queries]]
name = "multipleMissing2"
query = '''
  sequence with maxspan=1s
    [ test4 where tag == "A" ]
    [ test4 where tag == "B" ]
   -[ test4 where tag == "M1"]
    [ test4 where tag == "C" ]
    [ test4 where tag == "D" ]
'''
expected_event_ids  = [13, 14, 16, 17]

[[queries]]
name = "multipleMissing3"
query = '''
  sequence with maxspan=1s
    [ test4 where tag == "A" ]
    [ test4 where tag == "B" ]
    [ test4 where tag == "C" ]
   -[ test4 where tag == "M2"]
    [ test4 where tag == "D" ]
'''
expected_event_ids  = [13, 14, 16, 17]


[[queries]]
name = "multipleMissing4"
query = '''
  sequence with maxspan=1s
    [ test4 where tag == "A" ]
    [ test4 where tag == "B" ]
   -[ test4 where tag == "M1"]
    [ test4 where tag == "C" ]
   -[ test4 where tag == "M2"]
    [ test4 where tag == "D" ]
   -[ test4 where tag == "M4"]
'''
expected_event_ids  = []


[[queries]]
name = "multipleMissing5"
query = '''
  sequence with maxspan=1s
    [ test4 where tag == "A" ]
    [ test4 where tag == "B" ]
   -[ test4 where tag == "none"]
    [ test4 where tag == "C" ]
   -[ test4 where tag == "none"]
    [ test4 where tag == "D" ]
'''
expected_event_ids  = [1, 2, 5, 7, 13, 14, 16, 17]

[[queries]]
name = "multipleMissing6"
query = '''
  sequence with maxspan=1s
    [ test4 where tag == "A" ]
    [ test4 where tag == "B" ]
    [ test4 where tag == "C" ]
   -[ test4 where tag == "M2"]
    [ test4 where tag == "D" ]
   -[ test4 where tag == "none"]
'''
expected_event_ids  = [13, 14, 16, 17]
