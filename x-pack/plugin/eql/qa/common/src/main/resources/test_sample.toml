[[queries]]
name = "anyRulesWithOneDifferentNameKey"
query = '''
  sample by host
    [any where uptime > 0]   by os
    [any where port > 100]   by op_sys 
    [any where bool == true] by os
'''
expected_event_ids  = [17,26,16,
                       13,23,110]
join_keys = ["doom","redhat",
             "farcry","win10"]


[[queries]]
name = "anyRulesWithORFilters"
query = '''
  sample by bool, host
    [any where uptime > 0 or bool == false]
    [any where port > 10000 or bool == false]
'''
expected_event_ids  = [13,23,
                       17,16]
join_keys = ["false","farcry",
             "true","doom"]


[[queries]]
name = "failureEventTypeWithORFilters"
query = '''
  sample by bool, host
    [failure where uptime > 0 or bool == false]
    [any where port > 10000 or bool == false]
'''
expected_event_ids  = [17,16]
join_keys = ["true","doom"]


[[queries]]
name = "alertEventTypeRulesWithORFilters"
query = '''
  sample by bool, host
    [alert where uptime > 0 or bool == false]
    [alert where port > 10000 or bool == false]
'''
expected_event_ids  = [13,23]
join_keys = ["false","farcry"]


[[queries]]
name = "ipAsKey"
query = '''
  sample by host
    [any where bool == true] by host_ip
    [any where uptime > 0] by ip
    [any where port > 100] by ip
'''
expected_event_ids  = [36,28,11]
join_keys = ["doom","10.0.0.1"]


[[queries]]
name = "keywordAsKey"
query = '''
   sample by missing_keyword
     [success where true] by host
     [failure where host == "doom"] by host
'''
expected_event_ids  = [18,37]
join_keys = ["test","doom"]


[[queries]]
name = "simpleIpAsKey"
query = '''
  sample
    [success where true] by ip
    [alert where startsWith~(os,"win")] by host_ip
'''
expected_event_ids  = [28,31]
join_keys = ["10.0.0.1"]


[[queries]]
name = "customDateFormatAsKey_SameIndexResults"
query = '''
  sample by @timestamp_pretty
    [alert where true]
    [failure where true]
'''
expected_event_ids  = [15,17]
join_keys = ["1671235200000"]


[[queries]]
name = "customDateFormatsAsKey_DifferentIndicesResults"
query = '''
  sample by @timestamp_pretty
    [alert where true]
    [failure where op_sys == "redhat"]
'''
expected_event_ids  = [15,27]
join_keys = ["1671235200000"]


[[queries]]
name = "customDateFormatsAsKey_DifferentKeyNames"
query = '''
  sample
    [success where stringContains~(os,"10")] by date
    [failure where os == "redhat"] by @timestamp_pretty
'''
expected_event_ids  = [38,17]
join_keys = ["1671235200000"]


[[queries]]
name = "nullValueAsJoinKey"
query = '''
  sample by missing_keyword
    [alert where missing_keyword == null and id == 110]
    [alert where bool == false]
'''
expected_event_ids  = []
join_keys = []
