---
"Test enrich crud apis":

  - do:
      enrich.put_policy:
        name: my_policy
        body:
          type: exact_match
          indices: ["bar*"]
          enrich_key: baz
          enrich_values: ["a", "b"]
  - is_true: acknowledged

  - do:
      enrich.execute_policy:
        name: my_policy
  - is_true: acknowledged

  - do:
      enrich.get_policy:
        name: my_policy
  - match: { type: exact_match }
  - match: { indices: ["bar*"] }
  - match: { enrich_key: baz }
  - match: { enrich_values: ["a", "b"] }

  - do:
      enrich.list_policy: {}
  - length: { policies: 1 }
  - match: { policies.0.name: my_policy }
  - match: { policies.0.type: exact_match }
  - match: { policies.0.indices: ["bar*"] }
  - match: { policies.0.enrich_key: baz }
  - match: { policies.0.enrich_values: ["a", "b"] }

  - do:
      enrich.delete_policy:
        name: my_policy
  - is_true: acknowledged
