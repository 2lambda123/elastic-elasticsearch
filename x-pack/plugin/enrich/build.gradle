apply plugin: 'elasticsearch.internal-es-plugin'
apply plugin: 'elasticsearch.internal-cluster-test'
esplugin {
  name 'x-pack-enrich'
  description 'Elasticsearch Expanded Pack Plugin - Enrich'
  classname 'org.elasticsearch.xpack.enrich.EnrichPlugin'
  extendedPlugins = ['x-pack-core']
}
base {
  archivesName = 'x-pack-enrich'
}

dependencies {
  compileOnly project(path: xpackModule('core'))
  api project(path: ':modules:reindex')
  testImplementation(testArtifact(project(xpackModule('core'))))
  testImplementation project(path: ':modules:ingest-common')
  testImplementation project(path: ':modules:lang-mustache')
  testImplementation project(path: ':modules:legacy-geo')
  testImplementation project(xpackModule('spatial'))
  testImplementation(testArtifact(project(xpackModule('monitoring'))))

  // Needed for mapping tests
  testImplementation project(path: xpackModule('analytics'))
  testImplementation project(path: xpackModule('mapper-aggregate-metric'))
  testImplementation project(path: ':plugins:analysis-icu')
  testImplementation project(path: ':plugins:mapper-annotated-text')
  testImplementation project(path: xpackModule('mapper-constant-keyword'))
  testImplementation project(path: ':plugins:mapper-murmur3')
  testImplementation project(path: ':plugins:mapper-size')
  testImplementation project(path: ':modules:mapper-extras')
  testImplementation project(path: ':modules:parent-join')
  testImplementation project(path: ':modules:percolator')
  testImplementation(project(path: xpackModule('security'))) {
    exclude group: 'com.sun.mail', module: 'jakarta.mail'
    exclude group: 'com.google.guava', module: 'guava'
  }
  testImplementation project(path: xpackModule('spatial'))
  testImplementation project(path: xpackModule('mapper-unsigned-long'))
  testImplementation project(path: xpackModule('mapper-version'))
  testImplementation project(path: xpackModule('wildcard'))
}

addQaCheckDependencies(project)
