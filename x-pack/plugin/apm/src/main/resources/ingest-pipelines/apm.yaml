---
version: ${xpack.apm.template.version}
_meta:
  managed: true
description: |
  Built-in ingest pipeline for all APM data streams.
processors:
- rename:
    field: process.ppid
    target_field: process.parent.pid
    ignore_failure: true
    ignore_missing: true
- geoip:
    database_file: GeoLite2-City.mmdb
    field: client.ip
    target_field: client.geo
    download_database_on_pipeline_creation: false
    ignore_missing: true
    on_failure:
    - remove:
        field: client.ip
- user_agent:
    field: user_agent.original
    target_field: user_agent
    ignore_failure: true
    ignore_missing: true
- date:
    description: "Add time when event was ingested (and remove sub-seconds to improve storage efficiency)"
    field: _ingest.timestamp
    target_field: event.ingested
    formats: ["ISO8601"]
    output_format: date_time_no_millis
    ignore_failure: true
