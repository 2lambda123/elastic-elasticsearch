{
  "mappings": {
    "dynamic_templates": [
      {
        "ecs_timestamp": {
          "mapping": {
            "ignore_malformed": false,
            "type": "date"
          },
          "match": "@timestamp"
        }
      },
      {
        "message_match_only_text": {
          "mapping": {
            "type": "match_only_text"
          },
          "match": "message"
        }
      },
      {
        "ip_to_ip": {
          "mapping": {
            "type": "ip"
          },
          "match": "ip",
          "match_mapping_type": "string"
        }
      },
      {
        "_ip_to_ip": {
          "mapping": {
            "type": "ip"
          },
          "path_match": "*_ip",
          "match_mapping_type": "string"
        }
      },
      {
        "wildcard": {
          "mapping": {
            "type": "wildcard"
          },
          "path_match": [
            "*.io.text",
            "registry.data.strings",
            "*url.path"
          ]
        }
      },
      {
        "command_line_to_multifield": {
          "mapping": {
            "fields": {
              "text": {
                "type": "match_only_text"
              }
            },
            "type": "wildcard"
          },
          "match": "command_line"
        }
      },
      {
        "error_stack_trace_to_multifield": {
          "mapping": {
            "fields": {
              "text": {
                "type": "match_only_text"
              }
            },
            "type": "wildcard"
          },
          "match": "stack_trace"
        }
      },
      {
        "http_content_to_multifield": {
          "mapping": {
            "fields": {
              "text": {
                "type": "match_only_text"
              }
            },
            "type": "wildcard"
          },
          "path_match": "*.body.content"
        }
      },
      {
        "url_full_to_multifield": {
          "mapping": {
            "fields": {
              "text": {
                "type": "match_only_text"
              }
            },
            "type": "wildcard"
          },
          "path_match": "*.url.full"
        }
      },
      {
        "url_original_to_multifield": {
          "mapping": {
            "fields": {
              "text": {
                "type": "match_only_text"
              }
            },
            "type": "wildcard"
          },
          "path_match": "*.url.original"
        }
      },
      {
        "user_agent_original_to_multifield": {
          "mapping": {
            "fields": {
              "text": {
                "type": "match_only_text"
              }
            },
            "type": "wildcard"
          },
          "path_match": "user_agent.original"
        }
      },
      {
        "file_path_to_multifield": {
          "mapping": {
            "fields": {
              "text": {
                "type": "match_only_text"
              }
            },
            "type": "keyword"
          },
          "path_match": "*.file.path"
        }
      },
      {
        "file_target_path_to_multifield": {
          "mapping": {
            "fields": {
              "text": {
                "type": "match_only_text"
              }
            },
            "type": "keyword"
          },
          "path_match": "*.file.target_path"
        }
      },
      {
        "os_full_to_multifield": {
          "mapping": {
            "fields": {
              "text": {
                "type": "match_only_text"
              }
            },
            "type": "keyword"
          },
          "path_match": "*.os.full"
        }
      },
      {
        "title_to_multifield": {
          "mapping": {
            "fields": {
              "text": {
                "type": "match_only_text"
              }
            },
            "type": "keyword"
          },
          "match": "title"
        }
      },
      {
        "executable_to_multifield": {
          "mapping": {
            "fields": {
              "text": {
                "type": "match_only_text"
              }
            },
            "type": "keyword"
          },
          "match": "executable"
        }
      },
      {
        "name_to_multifield": {
          "mapping": {
            "fields": {
              "text": {
                "type": "match_only_text"
              }
            },
            "type": "keyword"
          },
          "match": "name"
        }
      },
      {
        "full_name_to_multifield": {
          "mapping": {
            "fields": {
              "text": {
                "type": "match_only_text"
              }
            },
            "type": "keyword"
          },
          "match": "full_name"
        }
      },
      {
        "working_directory_to_multifield": {
          "mapping": {
            "fields": {
              "text": {
                "type": "match_only_text"
              }
            },
            "type": "keyword"
          },
          "match": "working_directory"
        }
      },
      {
        "date": {
          "mapping": {
            "type": "date"
          },
          "match": [
            "timestamp",
            "delivery_timestamp",
            "not_after",
            "not_before",
            "accessed",
            "origination_timestamp",
            "created",
            "installed",
            "creation_date",
            "ctime",
            "mtime",
            "ingested",
            "start",
            "end"
          ]
        }
      },
      {
        "path_match_float": {
          "mapping": {
            "type": "float"
          },
          "path_match": [
            "*.score.base",
            "*.score.temporal"
          ]
        }
      },
      {
        "match_float": {
          "mapping": {
            "type": "float"
          },
          "match": [
            "*_score",
            "*_score_norm"
          ]
        }
      },
      {
        "usage_to_float": {
          "mapping": {
            "scaling_factor": 1000,
            "type": "scaled_float"
          },
          "match": "usage"
        }
      },
      {
        "location_to_geo_point": {
          "mapping": {
            "type": "geo_point"
          },
          "match": "location"
        }
      },
      {
        "flattened": {
          "mapping": {
            "type": "flattened"
          },
          "match": [
            "exports",
            "structured_data",
            "*imports"
          ]
        }
      },
      {
        "ecs_strings_as_keyword": {
          "mapping": {
            "ignore_above": 1024,
            "type": "keyword"
          },
          "match_mapping_type": "string"
        }
      }
    ]
  }
}
